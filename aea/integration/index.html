<!DOCTYPE html>
<html lang="en" class=''>

<head>
    <meta charset="utf-8">
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <title>Using public ledgers - Fetch.ai Developer Documentation</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <meta name="description" content="Everything you need to know about Fetch.ai.">
    <meta name="generator" content="mkdocs-1.0.4, mkdocs-">
    
    <meta name="author" content="developer@fetch.ai">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="shortcut icon" href="../../images/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

    <meta name="HandheldFriendly" content="true" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta rel="next" href="" />
    <script type="text/javascript" src="//code.jquery.com/jquery-1.9.1.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>var base_url = '../..';</script>
    <link href="../../css/style.min.css" rel="stylesheet">
    <link href="../../css/my-styles.css" rel="stylesheet"> 
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
    <script src="https://kit.fontawesome.com/392c70381a.js" crossorigin="anonymous" SameSite="None" Secure></script>
</head>

<body>
    <div id="page-container">
        <div id="content-wrap">

            <div id="mkdocs-search-wrapper">
                <div class="search-results-container">
                    <header>Search results: <input type="text" id="search-text-copy" />
                        <button id="closeSearchResults">&times;</button>
                    </header>
                    <div id="mkdocs-search-results" class="search-popup">
                        Sorry, page not found.
                    </div><!-- #mkdocs-search-results end -->
                </div><!-- .search-results-container -->
            </div><!-- #mkdocs-search-wrapper end -->

            <header>
                <button id='hamburger'><i class="fas fa-bars"></i><i class="fas fa-times"></i></button>
                <div class="corset">
                    <a href="https://fetch.ai" target="_blank">
                        <img src="../../assets/images/fetchai_logo_align_white.svg" alt="Fetch Logo" class="logo">
                    </a>
                    <nav class="menu">
                        <ul>
                            <li><a href="https://developer.fetch.ai/bounties">Bounty</a></li>
                            <li><a href="https://blockexplorer-alpha.fetch-ai.com/">Explorer</a></li>
                            <li><a href="http://build.fetch.ai">Build</a></li>
                            <li><a href="http://developer.fetch.ai/#links">Links</a></li>
                            <li><a href="https://docs.fetch.ai/tutorials/">Tutorials</a></li>
                        </ul>
                    </nav>
                </div><!-- .corset -->
            </header>
            <div class="book">
                <div id="book-search-input" role="search">
                    <form action="search.html" id="searchForm">
                        <input name="q" id="mkdocs-search-query" type="text" placeholder="Type to search">
                    </form>
                </div> <!-- #book-search-input end -->

                <div class="book-summary not-loaded">
                    <div>

                        <nav role="navigation" id="nav">
    <ul class="summary" id="summary"> 
<li>
    <a href="/" id="-"
        >Home</a
    >
</li>
 
<li>
    <span class="head">Getting Started</span>
    <ul id="header_getting_started"> 
<li>
    <a href="../../getting-started/quickstart/" id="getting-started-quickstart-"
        >Quickstart</a
    >
</li>
 
<li>
    <a href="../../getting-started/versions/" id="getting-started-versions-"
        >Versions</a
    >
</li>
 
<li>
    <a href="../../getting-started/wallet/" id="getting-started-wallet-"
        >Wallets</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Walkthrough</span>
    <ul id="header_walkthrough"> 
<li>
    <a href="../../walkthrough/" id="walkthrough-"
        >Introduction</a
    >
</li>
 
<li>
    <a href="../../walkthrough/creating-addresses/" id="walkthrough-creating-addresses-"
        >Creating Addresses</a
    >
</li>
 
<li>
    <a href="../../walkthrough/transfers-and-balances/" id="walkthrough-transfers-and-balances-"
        >Making Transfers</a
    >
</li>
 
<li>
    <a href="../../walkthrough/smart-contracts/" id="walkthrough-smart-contracts-"
        >Smart Contracts</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Ledger</span>
    <ul id="header_ledger"> 
<li>
    <a href="../../ledger/" id="ledger-"
        >Introduction</a
    >
</li>
 
<li>
    <a href="../../ledger/architecture/" id="ledger-architecture-"
        >Architecture</a
    >
</li>
 
<li>
    <span class="head">Usage</span>
    <ul id="header_usage"> 
<li>
    <span class="head">Installation</span>
    <ul id="header_installation"> 
<li>
    <a href="../../getting-started/installation-mac/" id="getting-started-installation-mac-"
        >MacOS</a
    >
</li>
 
<li>
    <a href="../../getting-started/installation-ubuntu/" id="getting-started-installation-ubuntu-"
        >Ubuntu</a
    >
</li>
 
<li>
    <a href="../../getting-started/installation-redhat/" id="getting-started-installation-redhat-"
        >Redhat</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../../ledger/running-a-constellation/" id="ledger-running-a-constellation-"
        >Running a node</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Maths and ML</span>
    <ul id="header_maths_and_ml"> 
<li>
    <a href="../../ledger/maths-lib-overview/" id="ledger-maths-lib-overview-"
        >Maths library introduction</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Python API</span>
    <ul id="header_python_api"> 
<li>
    <a href="../../getting-started/python-api-install/" id="getting-started-python-api-install-"
        >Installation</a
    >
</li>
 
<li>
    <span class="head">Examples</span>
    <ul id="header_examples"> 
<li>
    <a href="../../ledger/python-ledger-api/examples/block-number/" id="ledger-python-ledger-api-examples-block-number-"
        >Block Number</a
    >
</li>

    </ul>
</li>
    </ul>
</li>
    </ul>
</li> 
<li>
    <span class="head">Agent Framework</span>
    <ul id="header_agent_framework"> 
<li>
    <a href="../" id="aea-"
        >Welcome</a
    >
</li>
 
<li>
    <span class="head">Getting started</span>
    <ul id="header_getting_started"> 
<li>
    <a href="../steps/" id="aea-steps-"
        >Ways to build an AEA</a
    >
</li>
 
<li>
    <a href="../quickstart/" id="aea-quickstart-"
        >AEA quick start</a
    >
</li>
 
<li>
    <a href="../aea-vs-mvc/" id="aea-aea-vs-mvc-"
        >AEA and web frameworks</a
    >
</li>
 
<li>
    <a href="../build-aea-step-by-step/" id="aea-build-aea-step-by-step-"
        >Build an AEA with the CLI</a
    >
</li>
 
<li>
    <a href="../skill-guide/" id="aea-skill-guide-"
        >Build a skill for an AEA</a
    >
</li>
 
<li>
    <a href="../build-aea-programmatically/" id="aea-build-aea-programmatically-"
        >Build an AEA programmatically</a
    >
</li>
 
<li>
    <a href="../agent-vs-aea/" id="aea-agent-vs-aea-"
        >AEAs vs Agents</a
    >
</li>
 
<li>
    <a href="../cli-vs-programmatic-aeas/" id="aea-cli-vs-programmatic-aeas-"
        >CLI vs programmatic AEAs</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">The AEA universe</span>
    <ul id="header_the_aea_universe"> 
<li>
    <a href="../agent-oriented-development/" id="aea-agent-oriented-development-"
        >Agent-oriented development</a
    >
</li>
 
<li>
    <a href="../vision/" id="aea-vision-"
        >Vision</a
    >
</li>
 
<li>
    <a href="../app-areas/" id="aea-app-areas-"
        >Application areas</a
    >
</li>
 
<li>
    <a href="../oef-ledger/" id="aea-oef-ledger-"
        >Relation to OEF and Ledger</a
    >
</li>
 
<li>
    <a href="../trust/" id="aea-trust-"
        >Trust issues</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Demo guides</span>
    <ul id="header_demo_guides"> 
<li>
    <a href="../car-park-skills/" id="aea-car-park-skills-"
        >Car park skills</a
    >
</li>
 
<li>
    <a href="../gym-example/" id="aea-gym-example-"
        >Gym example</a
    >
</li>
 
<li>
    <a href="../gym-skill/" id="aea-gym-skill-"
        >Gym skill</a
    >
</li>
 
<li>
    <a href="../ml-skills/" id="aea-ml-skills-"
        >ML skills</a
    >
</li>
 
<li>
    <a href="../tac-skills/" id="aea-tac-skills-"
        >TAC skills</a
    >
</li>
 
<li>
    <a href="../tac/" id="aea-tac-"
        >TAC external app</a
    >
</li>
 
<li>
    <a href="../thermometer-skills/" id="aea-thermometer-skills-"
        >Thermometer skills</a
    >
</li>
 
<li>
    <a href="../weather-skills/" id="aea-weather-skills-"
        >Weather skills</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Use cases</span>
    <ul id="header_use_cases"> 
<li>
    <a href="../generic-skills/" id="aea-generic-skills-"
        >Generic skills</a
    >
</li>
 
<li>
    <a href="../orm-integration-to-generic/" id="aea-orm-integration-to-generic-"
        >ORM integration</a
    >
</li>
 
<li>
    <a href="../connect-a-frontend/" id="aea-connect-a-frontend-"
        >Frontend intergration</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Step by step guides</span>
    <ul id="header_step_by_step_guides"> 
<li>
    <a href="../thermometer-skills-step-by-step/" id="aea-thermometer-skills-step-by-step-"
        >Thermometer skills step by step</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Architecture</span>
    <ul id="header_architecture"> 
<li>
    <a href="../design-principles/" id="aea-design-principles-"
        >Design principles</a
    >
</li>
 
<li>
    <a href="../diagram/" id="aea-diagram-"
        >Architectural diagram</a
    >
</li>
 
<li>
    <a href="../core-components/" id="aea-core-components-"
        >Core components</a
    >
</li>
 
<li>
    <a href="../file-structure/" id="aea-file-structure-"
        >File structure</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">CLI</span>
    <ul id="header_cli"> 
<li>
    <a href="../cli-how-to/" id="aea-cli-how-to-"
        >CLI tool</a
    >
</li>
 
<li>
    <a href="../cli-commands/" id="aea-cli-commands-"
        >Commands</a
    >
</li>
 
<li>
    <a href="../package-imports/" id="aea-package-imports-"
        >Package structure</a
    >
</li>
 
<li>
    <a href="../cli-gui/" id="aea-cli-gui-"
        >GUI</a
    >
</li>
 
<li>
    <a href="../wealth/" id="aea-wealth-"
        >Generating wealth</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Developer guides</span>
    <ul id="header_developer_guides"> 
<li>
    <a href="../version/" id="aea-version-"
        >Version</a
    >
</li>
 
<li>
    <a href="../skill/" id="aea-skill-"
        >Skill</a
    >
</li>
 
<li>
    <a href="../protocol/" id="aea-protocol-"
        >Protocol</a
    >
</li>
 
<li>
    <a href="../connection/" id="aea-connection-"
        >Connection</a
    >
</li>
 
<li>
    <a href="../scaffolding/" id="aea-scaffolding-"
        >Scaffolding packages</a
    >
</li>
 
<li>
    <a href="../generator/" id="aea-generator-"
        >Generating protocols</a
    >
</li>
 
<li>
    <a href="../logging/" id="aea-logging-"
        >Logging</a
    >
</li>
 
<li>
    <a href="../raspberry-set-up/" id="aea-raspberry-set-up-"
        >Build an AEA on a Raspberry Pi</a
    >
</li>
 
<li>
    <a href="./" id="aea-integration-"
        >Using public ledgers</a
    >
</li>
 
<li>
    <a href="../multiplexer-standalone/" id="aea-multiplexer-standalone-"
        >Use multiplexer stand-alone</a
    >
</li>
 
<li>
    <a href="../standalone-transaction/" id="aea-standalone-transaction-"
        >Create stand-alone transaction</a
    >
</li>
 
<li>
    <a href="../decision-maker-transaction/" id="aea-decision-maker-transaction-"
        >Create decision-maker transaction</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../questions-and-answers/" id="aea-questions-and-answers-"
        >Q&A</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Machine Learning</span>
    <ul id="header_machine_learning"> 
<li>
    <a href="../../machine-learning/" id="machine-learning-"
        >Introduction</a
    >
</li>
 
<li>
    <a href="../../machine-learning/library-architecture/" id="machine-learning-library-architecture-"
        >Library architecture</a
    >
</li>
 
<li>
    <a href="../../machine-learning/smart-contract-example/" id="machine-learning-smart-contract-example-"
        >AI in smart contracts</a
    >
</li>
 
<li>
    <a href="../../machine-learning/synergetic-contract-example/" id="machine-learning-synergetic-contract-example-"
        >AI in synergetic contracts</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Etch Language</span>
    <ul id="header_etch_language"> 
<li>
    <a href="../../etch-language/" id="etch-language-"
        >Introduction</a
    >
</li>
 
<li>
    <span class="head">Usage</span>
    <ul id="header_usage"> 
<li>
    <a href="../../etch-language/getstarted/" id="etch-language-getstarted-"
        >Getting started</a
    >
</li>
 
<li>
    <a href="../../etch-language/debug/" id="etch-language-debug-"
        >Debugging</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">The Basics</span>
    <ul id="header_the_basics"> 
<li>
    <a href="../../etch-language/syntax/" id="etch-language-syntax-"
        >Syntax</a
    >
</li>
 
<li>
    <a href="../../etch-language/variables/" id="etch-language-variables-"
        >Variables</a
    >
</li>
 
<li>
    <a href="../../etch-language/operators/" id="etch-language-operators-"
        >Operators</a
    >
</li>
 
<li>
    <a href="../../etch-language/logic/" id="etch-language-logic-"
        >Logical operators</a
    >
</li>
 
<li>
    <a href="../../etch-language/control-flow/" id="etch-language-control-flow-"
        >Control flow</a
    >
</li>
 
<li>
    <a href="../../etch-language/strings/" id="etch-language-strings-"
        >Strings</a
    >
</li>
 
<li>
    <a href="../../etch-language/arrays/" id="etch-language-arrays-"
        >Arrays</a
    >
</li>
 
<li>
    <a href="../../etch-language/functions/" id="etch-language-functions-"
        >Functions</a
    >
</li>
 
<li>
    <span class="head">Function Annotations</span>
    <ul id="header_function_annotations"> 
<li>
    <a href="../../etch-language/sc-annotations/" id="etch-language-sc-annotations-"
        >Smart contract annotations</a
    >
</li>
 
<li>
    <a href="../../etch-language/syn-annotations/" id="etch-language-syn-annotations-"
        >Synergetic contract annotations</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../../etch-language/error-checking/" id="etch-language-error-checking-"
        >Error checking</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Fetch Ledger Types</span>
    <ul id="header_fetch_ledger_types"> 
<li>
    <a href="../../etch-language/persistent-globals/" id="etch-language-persistent-globals-"
        >Persistent globals</a
    >
</li>
 
<li>
    <a href="../../etch-language/states/" id="etch-language-states-"
        >State</a
    >
</li>
 
<li>
    <a href="../../etch-language/sharded-state/" id="etch-language-sharded-state-"
        >ShardedState</a
    >
</li>
 
<li>
    <a href="../../etch-language/addresses/" id="etch-language-addresses-"
        >Address</a
    >
</li>
 
<li>
    <a href="../../etch-language/crypto/" id="etch-language-crypto-"
        >Cryptographic functions</a
    >
</li>
 
<li>
    <a href="../../etch-language/context/" id="etch-language-context-"
        >Context</a
    >
</li>
 
<li>
    <a href="../../etch-language/transaction/" id="etch-language-transaction-"
        >Transaction</a
    >
</li>
 
<li>
    <a href="../../etch-language/balance-transfer/" id="etch-language-balance-transfer-"
        >Balance and Transfer</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Mathematics</span>
    <ul id="header_mathematics"> 
<li>
    <a href="../../etch-language/maths-functions/" id="etch-language-maths-functions-"
        >Maths functions</a
    >
</li>
 
<li>
    <a href="../../etch-language/tensor/" id="etch-language-tensor-"
        >Tensor</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Machine Learning</span>
    <ul id="header_machine_learning"> 
<li>
    <a href="../../etch-language/model/" id="etch-language-model-"
        >Model</a
    >
</li>
 
<li>
    <a href="../../etch-language/graph/" id="etch-language-graph-"
        >Graph</a
    >
</li>
 
<li>
    <a href="../../etch-language/data-loaders/" id="etch-language-data-loaders-"
        >DataLoader</a
    >
</li>
 
<li>
    <a href="../../etch-language/optimiser/" id="etch-language-optimiser-"
        >Optimiser</a
    >
</li>
 
<li>
    <a href="../../etch-language/scaler/" id="etch-language-scaler-"
        >Scaler</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Examples</span>
    <ul id="header_examples"> 
<li>
    <a href="../../etch-language/examples/fetch-logo/" id="etch-language-examples-fetch-logo-"
        >Fetch logo</a
    >
</li>
 
<li>
    <a href="../../etch-language/examples/mandelbrot/" id="etch-language-examples-mandelbrot-"
        >Mandelbrot</a
    >
</li>
 
<li>
    <a href="../../etch-language/examples/searching-algorithms/" id="etch-language-examples-searching-algorithms-"
        >Searching algorithms</a
    >
</li>
 
<li>
    <a href="../../etch-language/examples/sorting-algorithms/" id="etch-language-examples-sorting-algorithms-"
        >Sorting algorithms</a
    >
</li>
 
<li>
    <a href="../../etch-language/examples/dft/" id="etch-language-examples-dft-"
        >Discrete Fourier Transformation</a
    >
</li>

    </ul>
</li>
    </ul>
</li> 
<li>
    <span class="head">Smart Contracts</span>
    <ul id="header_smart_contracts"> 
<li>
    <a href="../../smart-contracts/smart-contract-intro/" id="smart-contracts-smart-contract-intro-"
        >Introduction</a
    >
</li>
 
<li>
    <a href="../../smart-contracts/static-dynamic/" id="smart-contracts-static-dynamic-"
        >Static and dynamic contracts</a
    >
</li>
 
<li>
    <span class="head">Fetch.ai smart contracts</span>
    <ul id="header_fetch.ai_smart_contracts"> 
<li>
    <a href="../../smart-contracts/etch-smart-contracts/" id="smart-contracts-etch-smart-contracts-"
        >Smart contracts in Etch</a
    >
</li>
 
<li>
    <a href="../../smart-contracts/pipenv/" id="smart-contracts-pipenv-"
        >Development environment</a
    >
</li>
 
<li>
    <a href="../../smart-contracts/executing-smart-contract-code/" id="smart-contracts-executing-smart-contract-code-"
        >Executing smart contracts</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Synergetic contracts</span>
    <ul id="header_synergetic_contracts"> 
<li>
    <a href="../../smart-contracts/synergetic/" id="smart-contracts-synergetic-"
        >Synergetic contracts</a
    >
</li>
 
<li>
    <a href="../../smart-contracts/executing-synergetic-code/" id="smart-contracts-executing-synergetic-code-"
        >Executing synergetic contracts</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../../smart-contracts/memory/" id="smart-contracts-memory-"
        >Memory</a
    >
</li>
 
<li>
    <a href="../../smart-contracts/fees/" id="smart-contracts-fees-"
        >Fees</a
    >
</li>
 
<li>
    <a href="../../smart-contracts/wallets/" id="smart-contracts-wallets-"
        >Wallets</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Tutorials</span>
    <ul id="header_tutorials"> 
<li>
    <a href="../../tutorials/" id="tutorials-"
        >Introduction</a
    >
</li>
 
<li>
    <a href="../../tutorials/fet1/" id="tutorials-fet1-"
        >Create FET-1 contract</a
    >
</li>
 
<li>
    <a href="../../tutorials/python-deployment/" id="tutorials-python-deployment-"
        >Deploying an Etch contract with Python</a
    >
</li>
 
<li>
    <a href="https://www.youtube.com/watch?v=mwkAUh-_uxA&list=PL09jEkqdEp94oV7XYsHvfvHwMTBC0QfwJ" id="https:--www.youtube.com-watch?v=mwkAUh-_uxA&list=PL09jEkqdEp94oV7XYsHvfvHwMTBC0QfwJ"
        >Videos</a
    >
</li>

    </ul>
</li> 
    </ul>
</nav>
                    </div>
                </div> <!-- .book-summary end -->

                <div class="book-body">
                    <div class="body-inner" id="book-body">

                        <div class="page-wrapper" tabindex="-1" role="main">
                            <div class="page-inner" id="book-body-inner">

                                <section class="normal markdown-section p17">

                                    

<p>In this section, we show you how to integrate the AEA with the Fetch.ai and third-party ledgers.</p>
<p>The framework currently natively supports two ledgers:</p>
<ul>
<li>Fetch.ai</li>
<li>Ethereum</li>
</ul>
<p>To this end, the framework wraps APIs to interact with the two ledgers and exposes them in the <code>LedgerApis</code> class. The framework also wraps the account APIs to create identities on both ledgers and exposes them in the <code>Wallet</code>.</p>
<p>The <code>Wallet</code> holds instantiation of the abstract <code>Crypto</code> base class, in particular <code>FetchaiCrypto</code> and <code>EthereumCrypto</code>.</p>
<p>The <code>LedgerApis</code> holds instantiation of the abstract <code>LedgerApi</code> base class, in particular <code>FetchaiLedgerApi</code> and <code>EthereumLedgerApi</code>.
You can think the concrete implementations of the base class <code>LedgerApi</code> as wrappers of the blockchain specific python SDK. </p>
<h2 id="abstract-class-ledgerapi">Abstract class LedgerApi</h2>
<p>Each <code>LedgerApi</code> must implement all the methods based on the abstract class.
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">LedgerApi</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interface for ledger APIs.&quot;&quot;&quot;</span>

    <span class="n">identifier</span> <span class="o">=</span> <span class="s2">&quot;base&quot;</span>  <span class="c1"># type: str</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">api</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the underlying API object.</span>
<span class="sd">        If there is no such object, return None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</pre></div>
The api property can be used for low-level operation with the concrete ledger APIs.</p>
<p><div class="highlight"><pre><span></span>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">:</span> <span class="n">AddressLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the balance of a given account.</span>

<span class="sd">        This usually takes the form of a web request to be waited synchronously.</span>

<span class="sd">        :param address: the address.</span>
<span class="sd">        :return: the balance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</pre></div>
The <code>get_balance</code> method returns the amount of tokens we hold for a specific address.
<div class="highlight"><pre><span></span>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">send_transaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">crypto</span><span class="p">:</span> <span class="n">Crypto</span><span class="p">,</span>
        <span class="n">destination_address</span><span class="p">:</span> <span class="n">AddressLike</span><span class="p">,</span>
        <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">tx_fee</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">tx_nonce</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Submit a transaction to the ledger.</span>

<span class="sd">        If the mandatory arguments are not enough for specifying a transaction</span>
<span class="sd">        in the concrete ledger API, use keyword arguments for the additional parameters.</span>

<span class="sd">        :param tx_nonce: verifies the authenticity of the tx</span>
<span class="sd">        :param crypto: the crypto object associated to the payer.</span>
<span class="sd">        :param destination_address: the destination address of the payee.</span>
<span class="sd">        :param amount: the amount of wealth to be transferred.</span>
<span class="sd">        :param tx_fee: the transaction fee.</span>
<span class="sd">        :return: tx digest if successful, otherwise None</span>
<span class="sd">        &quot;&quot;&quot;</span>
</pre></div>
The <code>send_transaction</code> is where we must implement the logic for sending a transaction to the ledger. </p>
<p><div class="highlight"><pre><span></span>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">is_transaction_settled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tx_digest</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether a transaction is settled or not.</span>

<span class="sd">        :param tx_digest: the digest associated to the transaction.</span>
<span class="sd">        :return: True if the transaction has been settled, False o/w.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">validate_transaction</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tx_digest</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">seller</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
        <span class="n">client</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
        <span class="n">tx_nonce</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether a transaction is valid or not.</span>

<span class="sd">        :param seller: the address of the seller.</span>
<span class="sd">        :param client: the address of the client.</span>
<span class="sd">        :param tx_nonce: the transaction nonce.</span>
<span class="sd">        :param amount: the amount we expect to get from the transaction.</span>
<span class="sd">        :param tx_digest: the transaction digest.</span>

<span class="sd">        :return: True if the transaction referenced by the tx_digest matches the terms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</pre></div>
The <code>is_transaction_settled</code> and <code>validate_transaction</code> are two functions that helps us to verify a transaction digest.
<div class="highlight"><pre><span></span>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">generate_tx_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seller</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a random str message.</span>

<span class="sd">        :param seller: the address of the seller.</span>
<span class="sd">        :param client: the address of the client.</span>
<span class="sd">        :return: return the hash in hex.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</pre></div>
Lastly, we implemented a support function that generates a random hash to help us with verifying the uniqueness of transactions. The sender of the funds must include this hash in the transaction
as extra data for the transaction to be considered valid.</p>
<p>Next, we are going to discuss the different implementation of <code>send_transaction</code> and <code>validate_transacaction</code> for the two natively supported ledgers of the framework.</p>
<h2 id="fetchai-ledger">Fetch.ai Ledger</h2>
<p><div class="highlight"><pre><span></span> <span class="k">def</span> <span class="nf">send_transaction</span><span class="p">(</span>
         <span class="bp">self</span><span class="p">,</span>
         <span class="n">crypto</span><span class="p">:</span> <span class="n">Crypto</span><span class="p">,</span>
         <span class="n">destination_address</span><span class="p">:</span> <span class="n">AddressLike</span><span class="p">,</span>
         <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
         <span class="n">tx_fee</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
         <span class="n">tx_nonce</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="o">**</span><span class="n">kwargs</span>
     <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
         <span class="sd">&quot;&quot;&quot;Submit a transaction to the ledger.&quot;&quot;&quot;</span>
         <span class="n">tx_digest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">tokens</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span>
             <span class="n">crypto</span><span class="o">.</span><span class="n">entity</span><span class="p">,</span> <span class="n">destination_address</span><span class="p">,</span> <span class="n">amount</span><span class="p">,</span> <span class="n">tx_fee</span>
         <span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">sync</span><span class="p">(</span><span class="n">tx_digest</span><span class="p">)</span>
         <span class="k">return</span> <span class="n">tx_digest</span>
</pre></div>
As you can see, the implementation for sending a transcation to the Fetch.ai ledger is relatively trivial.</p>
<div class="admonition note">
  <p class="admonition-title">Note</p>
  <p>We cannot use the tx_nonce yet in the Fetch.ai ledger.</p>
</div>

<p><div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">is_transaction_settled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tx_digest</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
         <span class="sd">&quot;&quot;&quot;Check whether a transaction is settled or not.&quot;&quot;&quot;</span>
         <span class="n">tx_status</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">TxStatus</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">status</span><span class="p">(</span><span class="n">tx_digest</span><span class="p">))</span>
         <span class="n">is_successful</span> <span class="o">=</span> <span class="kc">False</span>
         <span class="k">if</span> <span class="n">tx_status</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="n">SUCCESSFUL_TERMINAL_STATES</span><span class="p">:</span>
             <span class="n">is_successful</span> <span class="o">=</span> <span class="kc">True</span>
         <span class="k">return</span> <span class="n">is_successful</span>
</pre></div>
<div class="highlight"><pre><span></span>    <span class="k">def</span> <span class="nf">validate_transaction</span><span class="p">(</span>
         <span class="bp">self</span><span class="p">,</span>
         <span class="n">tx_digest</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">seller</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
         <span class="n">client</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
         <span class="n">tx_nonce</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
         <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Check whether a transaction is valid or not.</span>

<span class="sd">         :param seller: the address of the seller.</span>
<span class="sd">         :param client: the address of the client.</span>
<span class="sd">         :param tx_nonce: the transaction nonce.</span>
<span class="sd">         :param amount: the amount we expect to get from the transaction.</span>
<span class="sd">         :param tx_digest: the transaction digest.</span>

<span class="sd">         :return: True if the random_message is equals to tx[&#39;input&#39;]</span>
<span class="sd">         &quot;&quot;&quot;</span>
         <span class="n">tx_contents</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">TxContents</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">contents</span><span class="p">(</span><span class="n">tx_digest</span><span class="p">))</span>
         <span class="n">transfers</span> <span class="o">=</span> <span class="n">tx_contents</span><span class="o">.</span><span class="n">transfers</span>
         <span class="n">seller_address</span> <span class="o">=</span> <span class="n">Address</span><span class="p">(</span><span class="n">seller</span><span class="p">)</span>
         <span class="n">is_valid</span> <span class="o">=</span> <span class="p">(</span>
             <span class="nb">str</span><span class="p">(</span><span class="n">tx_contents</span><span class="o">.</span><span class="n">from_address</span><span class="p">)</span> <span class="o">==</span> <span class="n">client</span>
             <span class="ow">and</span> <span class="n">amount</span> <span class="o">==</span> <span class="n">transfers</span><span class="p">[</span><span class="n">seller_address</span><span class="p">]</span>
         <span class="p">)</span>
         <span class="n">is_settled</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_transaction_settled</span><span class="p">(</span><span class="n">tx_digest</span><span class="o">=</span><span class="n">tx_digest</span><span class="p">)</span>
         <span class="n">result</span> <span class="o">=</span> <span class="n">is_valid</span> <span class="ow">and</span> <span class="n">is_settled</span>
         <span class="k">return</span> <span class="n">result</span>
</pre></div>
Inside the <code>validate_transcation</code> we request the contents of the transaction based on the tx_digest we received. We are checking that the address
of the client is the same as the one that is inside the <code>from</code> field of the transaction. Lastly, we are checking that the transaction is settled.
If both of these checks return True we consider the transaction as valid.</p>
<h2 id="ethereum-ledger">Ethereum Ledger</h2>
<p><div class="highlight"><pre><span></span>     <span class="k">def</span> <span class="nf">send_transaction</span><span class="p">(</span>
         <span class="bp">self</span><span class="p">,</span>
         <span class="n">crypto</span><span class="p">:</span> <span class="n">Crypto</span><span class="p">,</span>
         <span class="n">destination_address</span><span class="p">:</span> <span class="n">AddressLike</span><span class="p">,</span>
         <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
         <span class="n">tx_fee</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
         <span class="n">tx_nonce</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">chain_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
         <span class="o">**</span><span class="n">kwargs</span>
     <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
         <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Submit a transaction to the ledger.</span>

<span class="sd">         :param tx_nonce: verifies the authenticity of the tx</span>
<span class="sd">         :param crypto: the crypto object associated to the payer.</span>
<span class="sd">         :param destination_address: the destination address of the payee.</span>
<span class="sd">         :param amount: the amount of wealth to be transferred.</span>
<span class="sd">         :param tx_fee: the transaction fee.</span>
<span class="sd">         :param chain_id: the Chain ID of the Ethereum transaction. Default is 1 (i.e. mainnet).</span>
<span class="sd">         :return: the transaction digest, or None if not available.</span>
<span class="sd">         &quot;&quot;&quot;</span>
         <span class="n">nonce</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">getTransactionCount</span><span class="p">(</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">toChecksumAddress</span><span class="p">(</span><span class="n">crypto</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
         <span class="p">)</span>
         <span class="n">transaction</span> <span class="o">=</span> <span class="p">{</span>
             <span class="s2">&quot;nonce&quot;</span><span class="p">:</span> <span class="n">nonce</span><span class="p">,</span>
             <span class="s2">&quot;chainId&quot;</span><span class="p">:</span> <span class="n">chain_id</span><span class="p">,</span>
             <span class="s2">&quot;to&quot;</span><span class="p">:</span> <span class="n">destination_address</span><span class="p">,</span>
             <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
             <span class="s2">&quot;gas&quot;</span><span class="p">:</span> <span class="n">tx_fee</span><span class="p">,</span>
             <span class="s2">&quot;gasPrice&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">toWei</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_gas_price</span><span class="p">,</span> <span class="n">GAS_ID</span><span class="p">),</span>
             <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">tx_nonce</span><span class="p">,</span>
         <span class="p">}</span>
         <span class="n">gas_estimation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">estimateGas</span><span class="p">(</span><span class="n">transaction</span><span class="o">=</span><span class="n">transaction</span><span class="p">)</span>
         <span class="k">assert</span> <span class="p">(</span>
             <span class="n">tx_fee</span> <span class="o">&gt;=</span> <span class="n">gas_estimation</span>
         <span class="p">),</span> <span class="s2">&quot;Need to increase tx_fee in the configs to cover the gas consumption of the transaction. Estimated gas consumption is: </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
             <span class="n">gas_estimation</span>
         <span class="p">)</span>
         <span class="n">signed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">account</span><span class="o">.</span><span class="n">signTransaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">crypto</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>

         <span class="n">hex_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">sendRawTransaction</span><span class="p">(</span><span class="n">signed</span><span class="o">.</span><span class="n">rawTransaction</span><span class="p">)</span>

         <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;TX Hash: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">hex_value</span><span class="o">.</span><span class="n">hex</span><span class="p">())))</span>
         <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
             <span class="k">try</span><span class="p">:</span>
                 <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">getTransactionReceipt</span><span class="p">(</span><span class="n">hex_value</span><span class="p">)</span>
                 <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;transaction validated - exiting&quot;</span><span class="p">)</span>
                 <span class="n">tx_digest</span> <span class="o">=</span> <span class="n">hex_value</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
                 <span class="k">break</span>
             <span class="k">except</span> <span class="n">web3</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">TransactionNotFound</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
                 <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;transaction not found - sleeping for 3.0 seconds&quot;</span><span class="p">)</span>
                 <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
         <span class="k">return</span> <span class="n">tx_digest</span>
</pre></div>
On contrary to the Fetch.ai implementation of the <code>send_transaction</code> function, the Ethereum implementation is more complicated. This happens because we must create 
the transaction dictionary and send a raw transaction.</p>
<ul>
<li>The <code>nonce</code> is a counter for the transaction we are sending. This is an auto-increment int based on how many transactions we are sending from the specific account.</li>
<li>The <code>chain_id</code> specifies if we are trying to reach the <code>mainnet</code> or another <code>testnet</code>.</li>
<li>The <code>to</code> field is the address we want to send the funds.</li>
<li>The <code>value</code> is the number of tokens we want to transfer.</li>
<li>The <code>gas</code> is the price we are paying to be able to send the transaction.</li>
<li>The <code>gasPrice</code> is the price of the gas we want to pay.</li>
<li>The <code>data</code> in the field that enables to send custom data (originally is used to send data to a smart contract).</li>
</ul>
<p>Once we filled the transaction dictionary. We are checking that the transaction fee is more than the estimated gas for the transaction otherwise we will not be able to complete the transfer. Then we are signing and we are sending the transaction. Once we get the transaction receipt we consider the transaction completed and
we return the transaction digest. </p>
<p><div class="highlight"><pre><span></span> <span class="k">def</span> <span class="nf">is_transaction_settled</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tx_digest</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
         <span class="sd">&quot;&quot;&quot;Check whether a transaction is settled or not.&quot;&quot;&quot;</span>
         <span class="n">tx_status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">getTransactionReceipt</span><span class="p">(</span><span class="n">tx_digest</span><span class="p">)</span>
         <span class="n">is_successful</span> <span class="o">=</span> <span class="kc">False</span>
         <span class="k">if</span> <span class="n">tx_status</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
             <span class="n">is_successful</span> <span class="o">=</span> <span class="kc">True</span>
         <span class="k">return</span> <span class="n">is_successful</span>
</pre></div>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">validate_transaction</span><span class="p">(</span>
         <span class="bp">self</span><span class="p">,</span>
         <span class="n">tx_digest</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">seller</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
         <span class="n">client</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
         <span class="n">tx_nonce</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
         <span class="n">amount</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
     <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
         <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Check whether a transaction is valid or not.</span>

<span class="sd">         :param seller: the address of the seller.</span>
<span class="sd">         :param client: the address of the client.</span>
<span class="sd">         :param tx_nonce: the transaction nonce.</span>
<span class="sd">         :param amount: the amount we expect to get from the transaction.</span>
<span class="sd">         :param tx_digest: the transaction digest.</span>

<span class="sd">         :return: True if the random_message is equals to tx[&#39;input&#39;]</span>
<span class="sd">         &quot;&quot;&quot;</span>

         <span class="n">tx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_api</span><span class="o">.</span><span class="n">eth</span><span class="o">.</span><span class="n">getTransaction</span><span class="p">(</span><span class="n">tx_digest</span><span class="p">)</span>
         <span class="n">is_valid</span> <span class="o">=</span> <span class="p">(</span>
             <span class="n">tx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">tx_nonce</span>
             <span class="ow">and</span> <span class="n">tx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">amount</span>
             <span class="ow">and</span> <span class="n">tx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;from&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">client</span>
             <span class="ow">and</span> <span class="n">tx</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;to&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">seller</span>
         <span class="p">)</span>
         <span class="k">return</span> <span class="n">is_valid</span>
</pre></div>
The <code>validate_transaction</code> and <code>is_transaction_settled</code> functions help us to check if a transaction digest is valid and is settled. 
In the Ethereum API, we can pass the <code>tx_nonce</code>, so we can check that it's the same. If it is different, we consider that transaction as no valid. The same happens if any of <code>amount</code>, <code>client</code> address
or the <code>seller</code> address is different.</p>
<p>Lastly, the <code>generate_tx_nonce</code> function is the same for both <code>LedgerApi</code> implementations but we use different hashing functions. 
Both use the timestamp as a random factor alongside the seller and client addresses.</p>
<h4 id="fetchai-implementation">Fetch.ai implementation</h4>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_tx_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seller</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a random str message.</span>

<span class="sd">    :param seller: the address of the seller.</span>
<span class="sd">    :param client: the address of the client.</span>
<span class="sd">    :return: return the hash in hex.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">time_stamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
    <span class="n">seller</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">seller</span><span class="p">)</span>
    <span class="n">client</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">client</span><span class="p">)</span>
    <span class="n">aggregate_hash</span> <span class="o">=</span> <span class="n">sha256_hash</span><span class="p">(</span>
        <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">seller</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">client</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">time_stamp</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;big&quot;</span><span class="p">)])</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">aggregate_hash</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</pre></div>

<h4 id="ethereum-implementation">Ethereum implementation</h4>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_tx_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seller</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span> <span class="n">client</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
         <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Generate a unique hash to distinguish txs with the same terms.</span>

<span class="sd">         :param seller: the address of the seller.</span>
<span class="sd">         :param client: the address of the client.</span>
<span class="sd">         :return: return the hash in hex.</span>
<span class="sd">         &quot;&quot;&quot;</span>
         <span class="n">time_stamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span>
         <span class="n">aggregate_hash</span> <span class="o">=</span> <span class="n">Web3</span><span class="o">.</span><span class="n">keccak</span><span class="p">(</span>
             <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">seller</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">client</span><span class="o">.</span><span class="n">encode</span><span class="p">(),</span> <span class="n">time_stamp</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;big&quot;</span><span class="p">)])</span>
         <span class="p">)</span>
         <span class="k">return</span> <span class="n">aggregate_hash</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</pre></div>


                                </section>

                            </div> <!-- .page-inner end -->

                            <div class="bottomnav">
                                
                                <a href="../raspberry-set-up/" class="button left"><strong>Previous:</strong></br>Build An Aea On A Raspberry Pi</a>
                                
                                <a href="../multiplexer-standalone/" class="button right"><strong>Next:</strong></br>Use Multiplexer Stand-Alone</a>
                            </div><!-- .bottomnav end -->

                        </div> <!-- .page-wrapper end -->

                    </div> <!-- .body-inner end -->
                </div> <!-- .book-body end -->

            </div><!-- .book end -->
        </div><!-- #content-wrap -->

        <footer>
            <div class="corset">
                <div class="col-1">
                    <div class="social">
                        <a href="https://t.me/fetch_ai" target="_blank"><i class="fab fa-telegram-plane" aria-hidden="true"></i></a>
                        <a href="https://twitter.com/fetch_ai?lang=en" target="_blank"><i class="fab fa-twitter" aria-hidden="true"></i></a>
                        <a href="https://www.linkedin.com/company/fetch-ai/" target="_blank"><i class="fab fa-linkedin" aria-hidden="true"></i></a>
                        <a href="https://www.youtube.com/c/FetchAI" target="_blank"><i class="fab fa-youtube" aria-hidden="true"></i></a>
                        <a href="https://medium.com/fetch-ai" target="_blank"><i class="fab fa-medium-m" aria-hidden="true"></i></a>
                        <a href="https://github.com/fetchai" target="_blank"><i class="fab fa-github" aria-hidden="true"></i></a>
                    </div>
                </div>
                <div class="col-2">Copyright © <a href="https://fetch.ai">Fetch.ai</a> <span class="year">2019</span></div>
            </div>
        </footer>
    </div><!-- end #page-container -->

    <link rel="stylesheet" id="font-awesome-css" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" type="text/css" media="all">
    <script src="../../js/main.js"></script>
    <script src="../../js/menu.js"></script>
    <script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script>
    <script src="../../search/main.js"></script>
</body>

</html>