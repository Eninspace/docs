<!DOCTYPE html>
<html lang="en" class=''>

<head>
    <meta charset="utf-8">
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <title>Protocols - Fetch.ai Developer Documentation</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <meta name="description" content="Everything you need to know about Fetch.ai.">
    <meta name="generator" content="mkdocs-1.1.2, mkdocs-">
    
    <meta name="author" content="developer@fetch.ai">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="shortcut icon" href="../../images/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

    <meta name="HandheldFriendly" content="true" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta rel="next" href="" />
    <script type="text/javascript" src="//code.jquery.com/jquery-1.9.1.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>var base_url = '../..';</script>
    <link href="../../css/style.min.css" rel="stylesheet">
    <link href="../../css/my-styles.css" rel="stylesheet">
    <link href="../../css/default.css" rel="stylesheet">
    <link href="../../css/dropdown-style.css" rel="stylesheet"> 
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
    <script src="https://kit.fontawesome.com/392c70381a.js" crossorigin="anonymous" SameSite="None" Secure></script>
</head>

<body>
    <div id="page-container">
        <div id="content-wrap">

            <div id="mkdocs-search-wrapper">
                <div class="search-results-container">
                    <header>Search results: <input type="text" id="search-text-copy" />
                        <button id="closeSearchResults">&times;</button>
                    </header>
                    <div id="mkdocs-search-results" class="search-popup">
                        Sorry, page not found.
                    </div><!-- #mkdocs-search-results end -->
                </div><!-- .search-results-container -->
            </div><!-- #mkdocs-search-wrapper end -->

            <header>
                <button id='hamburger'><i class="fas fa-bars"></i><i class="fas fa-times"></i></button>
                <div class="corset">
                    <a href="https://fetch.ai" target="_blank">
                        <img src="../../assets/images/fetchai_logo_align_white.svg" alt="Fetch Logo" class="logo">
                    </a>
                    <nav class="menu">
                        <ul>
                            <li><a href="https://developer.fetch.ai/Bounty">Bounty</a></li>
                            <li><a href="https://explore.fetch.ai">Explorer</a></li>
                            <li><a href="https://testnet-wallet.fetch.ai/">Testnet wallet</a></li>
                            <li><a href="https://aea-registry.fetch.ai">AEA Registry</a></li>
                            <li><a href="https://join.slack.com/t/fetch-ai/shared_invite/enQtNDI2MDYwMjE3OTQwLWY0ZjAyYjM0NGQzNWRhNDMxMzdjYmVhYTE3NDNhNTAyMTE0YWRkY2VmOWRmMGQ3ODM1N2NjOWUwNDExM2U3YjY">Support</a></li>
                        </ul>
                    </nav>
                </div><!-- .corset -->
            </header>
            <div class="book md-typeset">
                <div id="book-search-input" role="search">
                    <form action="search.html" id="searchForm">
                        <input name="q" id="mkdocs-search-query" type="text" placeholder="Type to search">
                    </form>
                </div> <!-- #book-search-input end -->

                <div class="book-summary not-loaded">
                    <div>

                        <nav role="navigation" id="nav">
    <ul class="summary" id="summary"> 
<li>
    <a href="/" id="-"
        >Home</a
    >
</li>
 
<li>
    <span class="head">Agent Framework</span>
    <ul id="header_agent_framework"> 
<li>
    <a href="../" id="aea-"
        >Introduction</a
    >
</li>
 
<li>
    <a href="../version/" id="aea-version-"
        >Version</a
    >
</li>
 
<li>
    <span class="head">Concepts</span>
    <ul id="header_concepts"> 
<li>
    <a href="../language-agnostic-definition/" id="aea-language-agnostic-definition-"
        >Language Agnostic Definition</a
    >
</li>
 
<li>
    <a href="../agent-oriented-development/" id="aea-agent-oriented-development-"
        >Agent-oriented development</a
    >
</li>
 
<li>
    <a href="../vision/" id="aea-vision-"
        >Vision</a
    >
</li>
 
<li>
    <a href="../app-areas/" id="aea-app-areas-"
        >Application areas</a
    >
</li>
 
<li>
    <a href="../oef-ledger/" id="aea-oef-ledger-"
        >Relation to OEF and Ledger</a
    >
</li>
 
<li>
    <a href="../identity/" id="aea-identity-"
        >Identity</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Demos</span>
    <ul id="header_demos"> 
<li>
    <a href="../demos/" id="aea-demos-"
        >Demos</a
    >
</li>
 
<li>
    <a href="../aries-cloud-agent-demo/" id="aea-aries-cloud-agent-demo-"
        >Aries Cloud Agents Demo</a
    >
</li>
 
<li>
    <a href="../car-park-skills/" id="aea-car-park-skills-"
        >Car park skills</a
    >
</li>
 
<li>
    <a href="../gym-example/" id="aea-gym-example-"
        >Gym example</a
    >
</li>
 
<li>
    <a href="../gym-skill/" id="aea-gym-skill-"
        >Gym skill</a
    >
</li>
 
<li>
    <a href="../ml-skills/" id="aea-ml-skills-"
        >ML skills</a
    >
</li>
 
<li>
    <a href="../tac-skills/" id="aea-tac-skills-"
        >TAC skills</a
    >
</li>
 
<li>
    <a href="../tac-skills-contract/" id="aea-tac-skills-contract-"
        >TAC skills ledger-based</a
    >
</li>
 
<li>
    <a href="../tac/" id="aea-tac-"
        >TAC external app</a
    >
</li>
 
<li>
    <a href="../thermometer-skills/" id="aea-thermometer-skills-"
        >Thermometer skills</a
    >
</li>
 
<li>
    <a href="../weather-skills/" id="aea-weather-skills-"
        >Weather skills</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Development</span>
    <ul id="header_development"> 
<li>
    <span class="head">Getting started</span>
    <ul id="header_getting_started"> 
<li>
    <a href="../quickstart/" id="aea-quickstart-"
        >AEA quick start</a
    >
</li>
 
<li>
    <a href="../core-components-1/" id="aea-core-components-1-"
        >Core components - Part 1</a
    >
</li>
 
<li>
    <a href="../aea-vs-mvc/" id="aea-aea-vs-mvc-"
        >AEA and web frameworks</a
    >
</li>
 
<li>
    <a href="../skill-guide/" id="aea-skill-guide-"
        >Build a skill for an AEA</a
    >
</li>
 
<li>
    <a href="../core-components-2/" id="aea-core-components-2-"
        >Core components - Part 2</a
    >
</li>
 
<li>
    <a href="../generic-skills-step-by-step/" id="aea-generic-skills-step-by-step-"
        >Trade between two AEAs</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Topic guides</span>
    <ul id="header_topic_guides"> 
<li>
    <a href="../step-one/" id="aea-step-one-"
        >Ways to build an AEA</a
    >
</li>
 
<li>
    <a href="../build-aea-step-by-step/" id="aea-build-aea-step-by-step-"
        >Build an AEA with the CLI</a
    >
</li>
 
<li>
    <a href="../scaffolding/" id="aea-scaffolding-"
        >Scaffolding packages</a
    >
</li>
 
<li>
    <a href="../protocol-generator/" id="aea-protocol-generator-"
        >Generating protocols</a
    >
</li>
 
<li>
    <a href="../logging/" id="aea-logging-"
        >Logging</a
    >
</li>
 
<li>
    <a href="../multiplexer-standalone/" id="aea-multiplexer-standalone-"
        >Use multiplexer stand-alone</a
    >
</li>
 
<li>
    <a href="../standalone-transaction/" id="aea-standalone-transaction-"
        >Create stand-alone transaction</a
    >
</li>
 
<li>
    <a href="../decision-maker-transaction/" id="aea-decision-maker-transaction-"
        >Create decision-maker transaction</a
    >
</li>
 
<li>
    <a href="../skill-testing/" id="aea-skill-testing-"
        >Testing Skills</a
    >
</li>
 
<li>
    <a href="../deployment/" id="aea-deployment-"
        >Deployment</a
    >
</li>
 
<li>
    <a href="../known-limits/" id="aea-known-limits-"
        >Known limitations</a
    >
</li>
 
<li>
    <a href="../build-aea-programmatically/" id="aea-build-aea-programmatically-"
        >Build an AEA programmatically</a
    >
</li>
 
<li>
    <a href="../cli-vs-programmatic-aeas/" id="aea-cli-vs-programmatic-aeas-"
        >CLI vs programmatic AEAs</a
    >
</li>
 
<li>
    <a href="../agent-vs-aea/" id="aea-agent-vs-aea-"
        >AEAs vs agents</a
    >
</li>
 
<li>
    <a href="../upgrading/" id="aea-upgrading-"
        >Upgrading versions</a
    >
</li>
 
<li>
    <a href="../modes/" id="aea-modes-"
        >Modes of running an AEA</a
    >
</li>
 
<li>
    <a href="../multi-agent-manager/" id="aea-multi-agent-manager-"
        >Multi agent manager</a
    >
</li>
 
<li>
    <a href="../debug/" id="aea-debug-"
        >Debugging</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Use case components</span>
    <ul id="header_use_case_components"> 
<li>
    <a href="../generic-skills/" id="aea-generic-skills-"
        >Generic skills</a
    >
</li>
 
<li>
    <a href="../connect-a-frontend/" id="aea-connect-a-frontend-"
        >Front-end intergration</a
    >
</li>
 
<li>
    <a href="../http-connection-and-skill/" id="aea-http-connection-and-skill-"
        >HTTP Connection</a
    >
</li>
 
<li>
    <a href="../orm-integration/" id="aea-orm-integration-"
        >ORM integration</a
    >
</li>
 
<li>
    <a href="../erc1155-skills/" id="aea-erc1155-skills-"
        >Contract deploy and interact</a
    >
</li>
 
<li>
    <a href="../p2p-connection/" id="aea-p2p-connection-"
        >P2P Connection</a
    >
</li>
 
<li>
    <a href="../raspberry-set-up/" id="aea-raspberry-set-up-"
        >Build an AEA on a Raspberry Pi</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Architecture & component deep-dives</span>
    <ul id="header_architecture_%26_component_deep-dives"> 
<li>
    <a href="../design-principles/" id="aea-design-principles-"
        >Design principles</a
    >
</li>
 
<li>
    <a href="../diagram/" id="aea-diagram-"
        >Architectural diagram</a
    >
</li>
 
<li>
    <a href="../connection/" id="aea-connection-"
        >Connections</a
    >
</li>
 
<li>
    <a href="./" id="aea-protocol-"
        >Protocols</a
    >
</li>
 
<li>
    <a href="../skill/" id="aea-skill-"
        >Skills</a
    >
</li>
 
<li>
    <a href="../contract/" id="aea-contract-"
        >Contracts</a
    >
</li>
 
<li>
    <a href="../decision-maker/" id="aea-decision-maker-"
        >Decision Maker</a
    >
</li>
 
<li>
    <a href="../ledger-integration/" id="aea-ledger-integration-"
        >Ledger & Crypto APIs</a
    >
</li>
 
<li>
    <a href="../message-routing/" id="aea-message-routing-"
        >Message routing</a
    >
</li>
 
<li>
    <a href="../config/" id="aea-config-"
        >Configurations</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Agent Communication</span>
    <ul id="header_agent_communication"> 
<li>
    <a href="../acn/" id="aea-acn-"
        >Agent Communication Network</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Search & Discovery</span>
    <ul id="header_search_%26_discovery"> 
<li>
    <a href="../defining-data-models/" id="aea-defining-data-models-"
        >Defining Data Models</a
    >
</li>
 
<li>
    <a href="../query-language/" id="aea-query-language-"
        >The Query Language</a
    >
</li>
 
<li>
    <a href="../simple-oef-usage/" id="aea-simple-oef-usage-"
        >SOEF Connection</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Developer Interfaces</span>
    <ul id="header_developer_interfaces"> 
<li>
    <span class="head">CLI</span>
    <ul id="header_cli"> 
<li>
    <a href="../cli-how-to/" id="aea-cli-how-to-"
        >Installation</a
    >
</li>
 
<li>
    <a href="../cli-commands/" id="aea-cli-commands-"
        >Commands</a
    >
</li>
 
<li>
    <a href="../package-imports/" id="aea-package-imports-"
        >File structure</a
    >
</li>
 
<li>
    <a href="../wealth/" id="aea-wealth-"
        >Generating wealth</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../cli-gui/" id="aea-cli-gui-"
        >GUI</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Benchmarks</span>
    <ul id="header_benchmarks"> 
<li>
    <a href="../performance-benchmark/" id="aea-performance-benchmark-"
        >Performance benchmark</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">API</span>
    <ul id="header_api"> 
<li>
    <a href="../api/abstract_agent/" id="aea-api-abstract_agent-"
        >AbstractAgent</a
    >
</li>
 
<li>
    <a href="../api/aea/" id="aea-api-aea-"
        >AEA</a
    >
</li>
 
<li>
    <a href="../api/aea_builder/" id="aea-api-aea_builder-"
        >AEA Builder</a
    >
</li>
 
<li>
    <a href="../api/agent/" id="aea-api-agent-"
        >Agent</a
    >
</li>
 
<li>
    <a href="../api/agent_loop/" id="aea-api-agent_loop-"
        >Agent Loop</a
    >
</li>
 
<li>
    <a href="../api/common/" id="aea-api-common-"
        >Common</a
    >
</li>
 
<li>
    <a href="../api/exceptions/" id="aea-api-exceptions-"
        >Exceptions</a
    >
</li>
 
<li>
    <a href="../api/launcher/" id="aea-api-launcher-"
        >Launcher</a
    >
</li>
 
<li>
    <a href="../api/manager/" id="aea-api-manager-"
        >Manager</a
    >
</li>
 
<li>
    <a href="../api/multiplexer/" id="aea-api-multiplexer-"
        >Multiplexer</a
    >
</li>
 
<li>
    <a href="../api/runner/" id="aea-api-runner-"
        >Runner</a
    >
</li>
 
<li>
    <a href="../api/runtime/" id="aea-api-runtime-"
        >Runtime</a
    >
</li>
 
<li>
    <span class="head">Components</span>
    <ul id="header_components"> 
<li>
    <a href="../api/components/base/" id="aea-api-components-base-"
        >Base</a
    >
</li>
 
<li>
    <a href="../api/components/loader/" id="aea-api-components-loader-"
        >Loader</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Configurations</span>
    <ul id="header_configurations"> 
<li>
    <a href="../api/configurations/base/" id="aea-api-configurations-base-"
        >Base</a
    >
</li>
 
<li>
    <a href="../api/configurations/constants/" id="aea-api-configurations-constants-"
        >Constants</a
    >
</li>
 
<li>
    <a href="../api/configurations/loader/" id="aea-api-configurations-loader-"
        >Loader</a
    >
</li>
 
<li>
    <a href="../api/configurations/project/" id="aea-api-configurations-project-"
        >Project</a
    >
</li>
 
<li>
    <a href="../api/configurations/pypi/" id="aea-api-configurations-pypi-"
        >Pypi</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Connections</span>
    <ul id="header_connections"> 
<li>
    <a href="../api/connections/base/" id="aea-api-connections-base-"
        >Base</a
    >
</li>
 
<li>
    <a href="../api/connections/stub/connection/" id="aea-api-connections-stub-connection-"
        >Stub Connection</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../api/context/base/" id="aea-api-context-base-"
        >Context</a
    >
</li>
 
<li>
    <span class="head">Contracts</span>
    <ul id="header_contracts"> 
<li>
    <a href="../api/contracts/base/" id="aea-api-contracts-base-"
        >Base</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Crypto</span>
    <ul id="header_crypto"> 
<li>
    <a href="../api/crypto/base/" id="aea-api-crypto-base-"
        >Base</a
    >
</li>
 
<li>
    <a href="../api/crypto/cosmos/" id="aea-api-crypto-cosmos-"
        >Cosmos</a
    >
</li>
 
<li>
    <a href="../api/crypto/ethereum/" id="aea-api-crypto-ethereum-"
        >Ethereum</a
    >
</li>
 
<li>
    <a href="../api/crypto/fetchai/" id="aea-api-crypto-fetchai-"
        >Fetchai</a
    >
</li>
 
<li>
    <a href="../api/crypto/helpers/" id="aea-api-crypto-helpers-"
        >Helpers</a
    >
</li>
 
<li>
    <a href="../api/crypto/ledger_apis/" id="aea-api-crypto-ledger_apis-"
        >LedgerApis</a
    >
</li>
 
<li>
    <a href="../api/crypto/wallet/" id="aea-api-crypto-wallet-"
        >Wallet</a
    >
</li>
 
<li>
    <span class="head">Registries</span>
    <ul id="header_registries"> 
<li>
    <a href="../api/crypto/registries/base/" id="aea-api-crypto-registries-base-"
        >Base</a
    >
</li>

    </ul>
</li>
    </ul>
</li> 
<li>
    <span class="head">Decision Maker</span>
    <ul id="header_decision_maker"> 
<li>
    <a href="../api/decision_maker/base/" id="aea-api-decision_maker-base-"
        >Base</a
    >
</li>
 
<li>
    <a href="../api/decision_maker/default/" id="aea-api-decision_maker-default-"
        >Default</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Helpers</span>
    <ul id="header_helpers"> 
<li>
    <a href="../api/helpers/async_friendly_queue/" id="aea-api-helpers-async_friendly_queue-"
        >Async Friendly Queue</a
    >
</li>
 
<li>
    <a href="../api/helpers/async_utils/" id="aea-api-helpers-async_utils-"
        >Async Utils</a
    >
</li>
 
<li>
    <a href="../api/helpers/base/" id="aea-api-helpers-base-"
        >Base</a
    >
</li>
 
<li>
    <span class="head">Dialogue</span>
    <ul id="header_dialogue"> 
<li>
    <a href="../api/helpers/dialogue/base/" id="aea-api-helpers-dialogue-base-"
        >Base</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../api/helpers/exception_policy/" id="aea-api-helpers-exception_policy-"
        >Exception Policy</a
    >
</li>
 
<li>
    <a href="../api/helpers/exec_timeout/" id="aea-api-helpers-exec_timeout-"
        >Exec Timeout</a
    >
</li>
 
<li>
    <a href="../api/helpers/file_lock/" id="aea-api-helpers-file_lock-"
        >File Lock</a
    >
</li>
 
<li>
    <span class="head">IPFS</span>
    <ul id="header_ipfs"> 
<li>
    <a href="../api/helpers/ipfs/base/" id="aea-api-helpers-ipfs-base-"
        >Base</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../api/helpers/logging/" id="aea-api-helpers-logging-"
        >Logging</a
    >
</li>
 
<li>
    <span class="head">MultiAddress</span>
    <ul id="header_multiaddress"> 
<li>
    <a href="../api/helpers/multiaddr/base/" id="aea-api-helpers-multiaddr-base-"
        >Base</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../api/helpers/multiple_executor/" id="aea-api-helpers-multiple_executor-"
        >MultipleExecutor</a
    >
</li>
 
<li>
    <a href="../api/helpers/pipe/" id="aea-api-helpers-pipe-"
        >Pipe</a
    >
</li>
 
<li>
    <span class="head">Preferences</span>
    <ul id="header_preferences"> 
<li>
    <a href="../api/helpers/preference_representations/base/" id="aea-api-helpers-preference_representations-base-"
        >Base</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Search</span>
    <ul id="header_search"> 
<li>
    <a href="../api/helpers/search/generic/" id="aea-api-helpers-search-generic-"
        >Generic</a
    >
</li>
 
<li>
    <a href="../api/helpers/search/models/" id="aea-api-helpers-search-models-"
        >Models</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Transaction</span>
    <ul id="header_transaction"> 
<li>
    <a href="../api/helpers/transaction/base/" id="aea-api-helpers-transaction-base-"
        >Base</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../api/helpers/win32/" id="aea-api-helpers-win32-"
        >Win32</a
    >
</li>
 
<li>
    <a href="../api/helpers/yaml_utils/" id="aea-api-helpers-yaml_utils-"
        >YamlUtils</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../api/identity/base/" id="aea-api-identity-base-"
        >Identity</a
    >
</li>
 
<li>
    <a href="../api/mail/base/" id="aea-api-mail-base-"
        >Mail</a
    >
</li>
 
<li>
    <span class="head">Protocols</span>
    <ul id="header_protocols"> 
<li>
    <a href="../api/protocols/base/" id="aea-api-protocols-base-"
        >Base</a
    >
</li>
 
<li>
    <span class="head">Generator</span>
    <ul id="header_generator"> 
<li>
    <a href="../api/protocols/generator/base/" id="aea-api-protocols-generator-base-"
        >Base</a
    >
</li>
 
<li>
    <a href="../api/protocols/generator/common/" id="aea-api-protocols-generator-common-"
        >Common</a
    >
</li>
 
<li>
    <a href="../api/protocols/generator/extract_specification/" id="aea-api-protocols-generator-extract_specification-"
        >Extract Specification</a
    >
</li>
 
<li>
    <a href="../api/protocols/generator/validate/" id="aea-api-protocols-generator-validate-"
        >Validate</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Default Protocol</span>
    <ul id="header_default_protocol"> 
<li>
    <a href="../api/protocols/default/custom_types/" id="aea-api-protocols-default-custom_types-"
        >Custom Types</a
    >
</li>
 
<li>
    <a href="../api/protocols/default/dialogues/" id="aea-api-protocols-default-dialogues-"
        >Dialogues</a
    >
</li>
 
<li>
    <a href="../api/protocols/default/message/" id="aea-api-protocols-default-message-"
        >Message</a
    >
</li>
 
<li>
    <a href="../api/protocols/default/serialization/" id="aea-api-protocols-default-serialization-"
        >Serialization</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Signing Protocol</span>
    <ul id="header_signing_protocol"> 
<li>
    <a href="../api/protocols/signing/custom_types/" id="aea-api-protocols-signing-custom_types-"
        >Custom Types</a
    >
</li>
 
<li>
    <a href="../api/protocols/signing/dialogues/" id="aea-api-protocols-signing-dialogues-"
        >Dialogues</a
    >
</li>
 
<li>
    <a href="../api/protocols/signing/message/" id="aea-api-protocols-signing-message-"
        >Message</a
    >
</li>
 
<li>
    <a href="../api/protocols/signing/serialization/" id="aea-api-protocols-signing-serialization-"
        >Serialization</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">State Update Protocol</span>
    <ul id="header_state_update_protocol"> 
<li>
    <a href="../api/protocols/state_update/dialogues/" id="aea-api-protocols-state_update-dialogues-"
        >Dialogues</a
    >
</li>
 
<li>
    <a href="../api/protocols/state_update/message/" id="aea-api-protocols-state_update-message-"
        >Message</a
    >
</li>
 
<li>
    <a href="../api/protocols/state_update/serialization/" id="aea-api-protocols-state_update-serialization-"
        >Serialization</a
    >
</li>

    </ul>
</li>
    </ul>
</li> 
<li>
    <span class="head">Registries</span>
    <ul id="header_registries"> 
<li>
    <a href="../api/registries/base/" id="aea-api-registries-base-"
        >Base</a
    >
</li>
 
<li>
    <a href="../api/registries/filter/" id="aea-api-registries-filter-"
        >Filter</a
    >
</li>
 
<li>
    <a href="../api/registries/resources/" id="aea-api-registries-resources-"
        >Resources</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Skills</span>
    <ul id="header_skills"> 
<li>
    <a href="../api/skills/base/" id="aea-api-skills-base-"
        >Base</a
    >
</li>
 
<li>
    <a href="../api/skills/error/handlers/" id="aea-api-skills-error-handlers-"
        >Error Skill</a
    >
</li>
 
<li>
    <a href="../api/skills/behaviours/" id="aea-api-skills-behaviours-"
        >Behaviors</a
    >
</li>
 
<li>
    <a href="../api/skills/tasks/" id="aea-api-skills-tasks-"
        >Task</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Test Tools</span>
    <ul id="header_test_tools"> 
<li>
    <a href="../api/test_tools/generic/" id="aea-api-test_tools-generic-"
        >Generic</a
    >
</li>
 
<li>
    <a href="../api/test_tools/test_cases/" id="aea-api-test_tools-test_cases-"
        >Test Cases</a
    >
</li>
 
<li>
    <a href="../api/test_tools/test_skill/" id="aea-api-test_tools-test_skill-"
        >Test Skill</a
    >
</li>

    </ul>
</li>
    </ul>
</li> 
<li>
    <a href="../glossary/" id="aea-glossary-"
        >Glossary</a
    >
</li>
 
<li>
    <a href="../questions-and-answers/" id="aea-questions-and-answers-"
        >Q&A</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../simple-oef/" id="aea-simple-oef-"
        >Simple OEF</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Ledger</span>
    <ul id="header_ledger"> 
<li>
    <a href="../../ledger/" id="ledger-"
        >Introduction</a
    >
</li>
 
<li>
    <span class="head">Using the ledger</span>
    <ul id="header_using_the_ledger"> 
<li>
    <a href="../../ledger/walkthrough/" id="ledger-walkthrough-"
        >Introduction</a
    >
</li>
 
<li>
    <a href="../../ledger/walkthrough/creating-addresses/" id="ledger-walkthrough-creating-addresses-"
        >Creating addresses</a
    >
</li>
 
<li>
    <a href="../../ledger/walkthrough/testnet-tokens/" id="ledger-walkthrough-testnet-tokens-"
        >Getting testnet tokens</a
    >
</li>
 
<li>
    <a href="../../ledger/walkthrough/transfers-and-balances/" id="ledger-walkthrough-transfers-and-balances-"
        >Making transfers</a
    >
</li>
 
<li>
    <a href="../../ledger/walkthrough/smart-contracts/" id="ledger-walkthrough-smart-contracts-"
        >Deploying smart contracts</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Smart Contracts</span>
    <ul id="header_smart_contracts"> 
<li>
    <a href="../../ledger/smart-contracts/smart-contract-intro/" id="ledger-smart-contracts-smart-contract-intro-"
        >Introduction</a
    >
</li>
 
<li>
    <a href="../../ledger/smart-contracts/static-dynamic/" id="ledger-smart-contracts-static-dynamic-"
        >Static and dynamic contracts</a
    >
</li>
 
<li>
    <span class="head">Fetch.ai smart contracts</span>
    <ul id="header_fetch.ai_smart_contracts"> 
<li>
    <a href="../../ledger/smart-contracts/etch-smart-contracts/" id="ledger-smart-contracts-etch-smart-contracts-"
        >Smart contracts in Etch</a
    >
</li>
 
<li>
    <a href="../../ledger/smart-contracts/pipenv/" id="ledger-smart-contracts-pipenv-"
        >Development environment</a
    >
</li>
 
<li>
    <a href="../../ledger/smart-contracts/executing-smart-contract-code/" id="ledger-smart-contracts-executing-smart-contract-code-"
        >Executing smart contracts</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Synergetic contracts</span>
    <ul id="header_synergetic_contracts"> 
<li>
    <a href="../../ledger/smart-contracts/synergetic/" id="ledger-smart-contracts-synergetic-"
        >Synergetic contracts</a
    >
</li>
 
<li>
    <a href="../../ledger/smart-contracts/executing-synergetic-code/" id="ledger-smart-contracts-executing-synergetic-code-"
        >Executing synergetic contracts</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../../ledger/smart-contracts/memory/" id="ledger-smart-contracts-memory-"
        >Memory</a
    >
</li>
 
<li>
    <a href="../../ledger/smart-contracts/fees/" id="ledger-smart-contracts-fees-"
        >Fees</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Machine Learning library</span>
    <ul id="header_machine_learning_library"> 
<li>
    <a href="../../ledger/machine-learning/" id="ledger-machine-learning-"
        >Introduction</a
    >
</li>
 
<li>
    <a href="../../ledger/machine-learning/library-architecture/" id="ledger-machine-learning-library-architecture-"
        >Architecture</a
    >
</li>
 
<li>
    <a href="../../ledger/machine-learning/getting-started/" id="ledger-machine-learning-getting-started-"
        >Getting started</a
    >
</li>
 
<li>
    <a href="../../ledger/machine-learning/smart-contract-example/" id="ledger-machine-learning-smart-contract-example-"
        >AI in smart contracts</a
    >
</li>
 
<li>
    <a href="../../ledger/machine-learning/synergetic-contract-example/" id="ledger-machine-learning-synergetic-contract-example-"
        >AI in synergetic contracts</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../../ledger/maths-lib-overview/" id="ledger-maths-lib-overview-"
        >Maths library</a
    >
</li>
 
<li>
    <span class="head">Python API</span>
    <ul id="header_python_api"> 
<li>
    <a href="../../ledger/python-ledger-api/python-api-install/" id="ledger-python-ledger-api-python-api-install-"
        >Installation</a
    >
</li>
 
<li>
    <span class="head">Examples</span>
    <ul id="header_examples"> 
<li>
    <a href="../../ledger/python-ledger-api/examples/block-number/" id="ledger-python-ledger-api-examples-block-number-"
        >Block Number</a
    >
</li>

    </ul>
</li>
    </ul>
</li> 
<li>
    <span class="head">Etch Language</span>
    <ul id="header_etch_language"> 
<li>
    <a href="../../ledger/etch-language/" id="ledger-etch-language-"
        >Introduction</a
    >
</li>
 
<li>
    <span class="head">Usage</span>
    <ul id="header_usage"> 
<li>
    <a href="../../ledger/etch-language/getstarted/" id="ledger-etch-language-getstarted-"
        >Getting started</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/debug/" id="ledger-etch-language-debug-"
        >Debugging</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">The Basics</span>
    <ul id="header_the_basics"> 
<li>
    <a href="../../ledger/etch-language/syntax/" id="ledger-etch-language-syntax-"
        >Syntax</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/variables/" id="ledger-etch-language-variables-"
        >Variables</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/operators/" id="ledger-etch-language-operators-"
        >Operators</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/logic/" id="ledger-etch-language-logic-"
        >Logical operators</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/control-flow/" id="ledger-etch-language-control-flow-"
        >Control flow</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/strings/" id="ledger-etch-language-strings-"
        >Strings</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/arrays/" id="ledger-etch-language-arrays-"
        >Arrays</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/functions/" id="ledger-etch-language-functions-"
        >Functions</a
    >
</li>
 
<li>
    <span class="head">Function Annotations</span>
    <ul id="header_function_annotations"> 
<li>
    <a href="../../ledger/etch-language/sc-annotations/" id="ledger-etch-language-sc-annotations-"
        >Smart contract annotations</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/syn-annotations/" id="ledger-etch-language-syn-annotations-"
        >Synergetic contract annotations</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../../ledger/etch-language/error-checking/" id="ledger-etch-language-error-checking-"
        >Error checking</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Fetch Ledger Types</span>
    <ul id="header_fetch_ledger_types"> 
<li>
    <a href="../../ledger/etch-language/persistent-globals/" id="ledger-etch-language-persistent-globals-"
        >Persistent globals</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/states/" id="ledger-etch-language-states-"
        >State</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/sharded-state/" id="ledger-etch-language-sharded-state-"
        >ShardedState</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/addresses/" id="ledger-etch-language-addresses-"
        >Address</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/crypto/" id="ledger-etch-language-crypto-"
        >Cryptographic functions</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/context/" id="ledger-etch-language-context-"
        >Context</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/transaction/" id="ledger-etch-language-transaction-"
        >Transaction</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/balance-transfer/" id="ledger-etch-language-balance-transfer-"
        >Balance and Transfer</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Mathematics</span>
    <ul id="header_mathematics"> 
<li>
    <a href="../../ledger/etch-language/maths-functions/" id="ledger-etch-language-maths-functions-"
        >Maths functions</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/tensor/" id="ledger-etch-language-tensor-"
        >Tensor</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Machine Learning</span>
    <ul id="header_machine_learning"> 
<li>
    <a href="../../ledger/etch-language/model/" id="ledger-etch-language-model-"
        >Model</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/graph/" id="ledger-etch-language-graph-"
        >Graph</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/data-loaders/" id="ledger-etch-language-data-loaders-"
        >DataLoader</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/optimiser/" id="ledger-etch-language-optimiser-"
        >Optimiser</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/scaler/" id="ledger-etch-language-scaler-"
        >Scaler</a
    >
</li>

    </ul>
</li> 
<li>
    <span class="head">Examples</span>
    <ul id="header_examples"> 
<li>
    <a href="../../ledger/etch-language/examples/fetch-logo/" id="ledger-etch-language-examples-fetch-logo-"
        >Fetch logo</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/examples/mandelbrot/" id="ledger-etch-language-examples-mandelbrot-"
        >Mandelbrot</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/examples/searching-algorithms/" id="ledger-etch-language-examples-searching-algorithms-"
        >Searching algorithms</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/examples/sorting-algorithms/" id="ledger-etch-language-examples-sorting-algorithms-"
        >Sorting algorithms</a
    >
</li>
 
<li>
    <a href="../../ledger/etch-language/examples/dft/" id="ledger-etch-language-examples-dft-"
        >Discrete Fourier Transformation</a
    >
</li>

    </ul>
</li>
    </ul>
</li> 
<li>
    <span class="head">Deploying nodes</span>
    <ul id="header_deploying_nodes"> 
<li>
    <span class="head">Building the code</span>
    <ul id="header_building_the_code"> 
<li>
    <a href="../../ledger/installation/installation-mac/" id="ledger-installation-installation-mac-"
        >MacOS</a
    >
</li>
 
<li>
    <a href="../../ledger/installation/installation-ubuntu/" id="ledger-installation-installation-ubuntu-"
        >Ubuntu</a
    >
</li>
 
<li>
    <a href="../../ledger/installation/installation-redhat/" id="ledger-installation-installation-redhat-"
        >Redhat</a
    >
</li>

    </ul>
</li> 
<li>
    <a href="../../ledger/running-a-constellation/" id="ledger-running-a-constellation-"
        >Running a node</a
    >
</li>
 
<li>
    <a href="../../ledger/architecture/" id="ledger-architecture-"
        >Architecture</a
    >
</li>

    </ul>
</li>
    </ul>
</li> 
<li>
    <span class="head">Tutorials</span>
    <ul id="header_tutorials"> 
<li>
    <a href="../../tutorials/" id="tutorials-"
        >Index</a
    >
</li>
 
<li>
    <a href="../../tutorials/fet1/" id="tutorials-fet1-"
        >Create FET-1 contract</a
    >
</li>

    </ul>
</li> 
    </ul>
</nav>
                    </div>
                </div> <!-- .book-summary end -->

                <div class="book-body">
                    <div class="body-inner" id="book-body">

                        <div class="page-wrapper" tabindex="-1" role="main">
                            <div class="page-inner" id="book-body-inner">

                                <section class="normal markdown-section p17">

                                    

<p><a href="../api/protocols/base#protocol-objects"><code>Protocols</code></a> define agent to agent interactions, which include:</p>
<ul>
<li>
<p>messages, which define the representation;</p>
</li>
<li>
<p>serialization logic, which define how a message is encoded for transport; and, optionally</p>
</li>
<li>
<p>dialogues, which define rules over message sequences.</p>
</li>
</ul>
<p>The framework provides one default protocol, called <code>default</code> and introduced below. This protocol provides a bare bones implementation for an AEA protocol which includes a <a href="../api/protocols/default/message#aea.protocols.default.message"><code>DefaultMessage</code></a>  class and associated <a href="../api/protocols/default/serialization#aea.protocols.default.serialization"><code>DefaultSerializer</code></a> and <a href="../api/protocols/default/dialogues#aea.protocols.default.dialogues"><code>DefaultDialogue</code></a> classes.</p>
<p>Additional protocols - i.e. a new type of interaction - can be added as packages or generated with the <a href="../protocol-generator">protocol generator</a>.</p>
<p>We highly recommend you <strong>do not</strong> attempt to write your own protocol code; always use existing packages or the protocol generator!</p>
<h2 id="components-of-a-protocol">Components of a protocol</h2>
<p>A protocol package contains the following files:</p>
<ul>
<li><code>__init__.py</code></li>
<li><code>message.py</code>, which defines message representation</li>
<li><code>serialization.py</code>, which defines the encoding and decoding logic</li>
<li>two protobuf related files</li>
</ul>
<p>It optionally also contains
* <code>dialogues.py</code>, which defines rules of the message exchange
* <code>custom_types.py</code>, which defines custom types </p>
<p>All protocols are for point to point interactions between two agents or agent-like services.</p>
<!-- ## Interaction Protocols

Protocols are not to be conflated with Interaction Protocols. The latter consist of three components in the AEA:

- Protocols: which deal with the syntax and potentially semantics of the message exchange
- Handlers: which handle incoming messages
- Behaviours: which execute pro-active patterns of one-shot, cyclic or even finite-state-machine-like type. -->

<h2 id="metadata">Metadata</h2>
<p>Each <code>Message</code> in an interaction protocol has a set of default fields:</p>
<ul>
<li><code>dialogue_reference: Tuple[str, str]</code>, a reference of the dialogue the message is part of. The first part of the tuple is the reference assigned to by the agent who first initiates the dialogue (i.e. sends the first message). The second part of the tuple is the reference assigned to by the other agent. * <code>dialogue_reference: Tuple[str, str]</code>, a reference of the dialogue the message is part of. The first part of the tuple is the reference assigned to by the dialogue initiator, the second part of the tuple is the reference assigned to by the dialogue responder. The default value is <code>("", "")</code>.</li>
<li><code>message_id: int</code>, the identifier of the message in a dialogue. The default value is <code>1</code>.</li>
<li><code>target: int</code>, the id of the message this message is replying to. The default value is <code>0</code>.</li>
<li><code>performative: Enum</code>, the purpose/intention of the message. </li>
<li><code>is_incoming: bool</code>, a boolean specifying whether the message is outgoing (from the agent), or incoming (from the other agent). The default value is <code>False</code>. </li>
<li><code>counterparty: Address</code>, the address of the counterparty of this agent; the other agent, this agent is communicating with.  </li>
</ul>
<p>The default values for the above fields assume the message is the first message by the agent in a dialogue. Therefore, the <code>message_id</code> is set to <code>1</code> indicating the first message in the dialogue, <code>target</code> is <code>0</code> since the first  message is the only message that does not reply to any other, and <code>is_incoming</code> is <code>False</code> indicating the message is by the agent itself.</p>
<p>By default, the values of <code>dialogue_reference</code>, <code>message_id</code>, <code>target</code>, <code>is_incoming</code>, <code>counterparty</code> are set. However, most interactions involve more than one message being sent as part of the interaction and potentially multiple simultaneous interactions utilising the same protocol. In those cases, the <code>dialogue_reference</code> allows different interactions to be identified as such. The <code>message_id</code> and <code>target</code> are used to keep track of messages and their replies. For instance, on receiving of a message with <code>message_id=1</code> and <code>target=0</code>, the responding agent could respond with a another with <code>message_id=2</code> and <code>target=1</code> replying to the first message. In particular, <code>target</code> holds the id of the message being replied to. This can be the preceding message, or an older one. </p>
<h2 id="contents">Contents</h2>
<p>Each message may optionally have any number of contents of varying types. </p>
<h2 id="dialogue-rules">Dialogue rules</h2>
<p>Protocols can optionally have a dialogue module. A <em>dialogue</em>, respectively <em>dialogues</em> object, maintains the state of a single dialogue, respectively all dialogues, associated with the protocol.</p>
<p>The framework provides a number of helpful classes which implement most of the logic to maintain dialogues, namely the <a href="../api/helpers/dialogue/base#dialogue-objects"><code>Dialogue</code></a> and <a href="../api/helpers/dialogue/base#dialogues-objects"><code>Dialogues</code></a> base classes.</p>
<h2 id="custom-protocol">Custom protocol</h2>
<p>The developer can generate custom protocols with the <a href="../protocol-generator">protocol generator</a>. This lets the developer specify the speech-acts as well as optionally the dialogue structure (e.g. roles of agents participating in a dialogue, the states a dialogue may end in, and the reply structure of the speech-acts in a dialogue).</p>
<p>We highly recommend you <strong>do not</strong> attempt to write your own protocol code; always use existing packages or the protocol generator!</p>
<h2 id="fetchaidefault070-protocol"><code>fetchai/default:0.7.0</code> protocol</h2>
<p>The <code>fetchai/default:0.7.0</code> protocol is a protocol which each AEA is meant to implement. It serves AEA to AEA interaction and includes two message performatives:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>

<span class="k">class</span> <span class="nc">Performative</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performatives for the default protocol.&quot;&quot;&quot;</span>

    <span class="n">BYTES</span> <span class="o">=</span> <span class="s2">&quot;bytes&quot;</span>
    <span class="n">ERROR</span> <span class="o">=</span> <span class="s2">&quot;error&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the string representation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</code></pre></div>

<ul>
<li>The <code>DefaultMessage</code> of performative <code>DefaultMessage.Performative.BYTES</code> is used to send payloads of byte strings to other AEAs. An example is:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">aea.protocols.default.message</span> <span class="kn">import</span> <span class="n">DefaultMessage</span>

<span class="n">msg</span> <span class="o">=</span> <span class="n">DefaultMessage</span><span class="p">(</span>
    <span class="n">performative</span><span class="o">=</span><span class="n">DefaultMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">BYTES</span><span class="p">,</span>
    <span class="n">content</span><span class="o">=</span><span class="sa">b</span><span class="s2">&quot;This is a bytes payload&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<ul>
<li>The <code>DefaultMessage</code> of performative <code>DefaultMessage.Performative.ERROR</code> is used to notify other AEAs of errors in an interaction, including errors with other protocols, by including an <code>error_code</code> in the payload:</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">ErrorCode</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class represents an instance of ErrorCode.&quot;&quot;&quot;</span>

    <span class="n">UNSUPPORTED_PROTOCOL</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">DECODING_ERROR</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">INVALID_MESSAGE</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">UNSUPPORTED_SKILL</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">INVALID_DIALOGUE</span> <span class="o">=</span> <span class="mi">4</span>
</code></pre></div>

<p>An example is:</p>
<div class="highlight"><pre><span></span><code><span class="n">msg</span> <span class="o">=</span> <span class="n">DefaultMessage</span><span class="p">(</span>
    <span class="n">performative</span><span class="o">=</span><span class="n">DefaultMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">ERROR</span><span class="p">,</span>
    <span class="n">error_code</span><span class="o">=</span><span class="n">DefaultMessage</span><span class="o">.</span><span class="n">ErrorCode</span><span class="o">.</span><span class="n">UNSUPPORTED_PROTOCOL</span><span class="p">,</span>
    <span class="n">error_msg</span><span class="o">=</span><span class="s2">&quot;This protocol is not supported by this AEA.&quot;</span><span class="p">,</span>
    <span class="n">error_data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;unsupported_msg&quot;</span><span class="p">:</span> <span class="sa">b</span><span class="s2">&quot;serialized unsupported protocol message&quot;</span><span class="p">},</span>
<span class="p">)</span>
</code></pre></div>

<p>Each AEA's <code>fetchai/error:0.7.0</code> skill utilises the <code>fetchai/default:0.7.0</code> protocol for error handling.</p>
<h2 id="fetchaioef_search080-protocol"><code>fetchai/oef_search:0.8.0</code> protocol</h2>
<p>The <code>fetchai/oef_search:0.8.0</code> protocol is used by AEAs to interact with an <a href="../simple-oef">SOEF search node</a> to register and unregister their own services and search for services registered by other agents.</p>
<p>The <code>fetchai/oef_search:0.8.0</code> protocol definition includes an <code>OefSearchMessage</code> with the following message types:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Performative</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;Performatives for the oef_search protocol.&quot;&quot;&quot;</span>
    <span class="n">REGISTER_SERVICE</span> <span class="o">=</span> <span class="s2">&quot;register_service&quot;</span>
    <span class="n">UNREGISTER_SERVICE</span> <span class="o">=</span> <span class="s2">&quot;unregister_service&quot;</span>
    <span class="n">SEARCH_SERVICES</span> <span class="o">=</span> <span class="s2">&quot;search_services&quot;</span>
    <span class="n">OEF_ERROR</span> <span class="o">=</span> <span class="s2">&quot;oef_error&quot;</span>
    <span class="n">SEARCH_RESULT</span> <span class="o">=</span> <span class="s2">&quot;search_result&quot;</span>
    <span class="n">SUCCESS</span> <span class="o">=</span> <span class="s2">&quot;success&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get string representation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</code></pre></div>

<p>We show some example messages below:</p>
<ul>
<li>To register a service, we require a reference to the dialogue in string form (used to keep different dialogues apart), for instance</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">my_dialogue_reference</span> <span class="o">=</span> <span class="s2">&quot;a_unique_register_service_dialogue_reference&quot;</span>
</code></pre></div>

<p>and a description of the service we would like to register, for instance</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">aea.helpers.search.models</span> <span class="kn">import</span> <span class="n">Description</span>

<span class="n">my_service_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;country&quot;</span><span class="p">:</span> <span class="s2">&quot;UK&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">:</span> <span class="s2">&quot;Cambridge&quot;</span><span class="p">}</span>
<span class="n">my_service_description</span> <span class="o">=</span> <span class="n">Description</span><span class="p">(</span>
    <span class="n">my_service_data</span><span class="p">,</span>
    <span class="n">data_model</span><span class="o">=</span><span class="n">my_data_model</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<p>where we use, for instance</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">aea.helpers.search.generic</span> <span class="kn">import</span> <span class="n">GenericDataModel</span>

<span class="n">data_model_name</span> <span class="o">=</span> <span class="s2">&quot;location&quot;</span>
<span class="n">data_model</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;attribute_one&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;country&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;str&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_required&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s2">&quot;attribute_two&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span>
        <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;str&quot;</span><span class="p">,</span>
        <span class="s2">&quot;is_required&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">}</span>
<span class="n">my_data_model</span> <span class="o">=</span> <span class="n">GenericDataModel</span><span class="p">(</span><span class="n">data_model_name</span><span class="p">,</span> <span class="n">data_model</span><span class="p">)</span>
</code></pre></div>

<p>We can then create the message to register this service:</p>
<div class="highlight"><pre><span></span><code><span class="n">msg</span> <span class="o">=</span> <span class="n">OefSearchMessage</span><span class="p">(</span>
    <span class="n">performative</span><span class="o">=</span><span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">REGISTER_SERVICE</span><span class="p">,</span>
    <span class="n">dialogue_reference</span><span class="o">=</span><span class="p">(</span><span class="n">my_dialogue_reference</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="n">service_description</span><span class="o">=</span><span class="n">my_service_description</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<ul>
<li>To unregister a service, we require a reference to the dialogue in string form, for instance</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">my_dialogue_reference</span> <span class="o">=</span> <span class="s2">&quot;a_unique_unregister_service_dialogue_reference&quot;</span>
</code></pre></div>

<p>the description of the service we would like to unregister, say <code>my_service_description</code> from above and construct the message:</p>
<div class="highlight"><pre><span></span><code><span class="n">msg</span> <span class="o">=</span> <span class="n">OefSearchMessage</span><span class="p">(</span>
    <span class="n">performative</span><span class="o">=</span><span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">UNREGISTER_SERVICE</span><span class="p">,</span>
    <span class="n">dialogue_reference</span><span class="o">=</span><span class="p">(</span><span class="n">my_dialogue_reference</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="n">service_description</span><span class="o">=</span><span class="n">my_service_description</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<ul>
<li>To search a service, we require a reference to the dialogue in string form, for instance</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">my_dialogue_reference</span> <span class="o">=</span> <span class="s2">&quot;a_unique_search_dialogue_reference&quot;</span>
</code></pre></div>

<p>and a query we would like the search node to evaluate, for instance</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">aea.helpers.search.models</span> <span class="kn">import</span> <span class="n">Constraint</span><span class="p">,</span> <span class="n">ConstraintType</span><span class="p">,</span> <span class="n">Query</span>

<span class="n">query_data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;search_term&quot;</span><span class="p">:</span> <span class="s2">&quot;country&quot;</span><span class="p">,</span>
    <span class="s2">&quot;search_value&quot;</span><span class="p">:</span> <span class="s2">&quot;UK&quot;</span><span class="p">,</span>
    <span class="s2">&quot;constraint_type&quot;</span><span class="p">:</span> <span class="s2">&quot;==&quot;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">Query</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">Constraint</span><span class="p">(</span>
            <span class="n">query_data</span><span class="p">[</span><span class="s2">&quot;search_term&quot;</span><span class="p">],</span>
            <span class="n">ConstraintType</span><span class="p">(</span>
                <span class="n">query_data</span><span class="p">[</span><span class="s2">&quot;constraint_type&quot;</span><span class="p">],</span>
                <span class="n">query_data</span><span class="p">[</span><span class="s2">&quot;search_value&quot;</span><span class="p">],</span>
            <span class="p">),</span>
        <span class="p">)</span>
    <span class="p">],</span>
    <span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<p>We can then create the message to search these services:</p>
<div class="highlight"><pre><span></span><code><span class="n">oef_msg</span> <span class="o">=</span> <span class="n">OefSearchMessage</span><span class="p">(</span>
    <span class="n">performative</span><span class="o">=</span><span class="n">OefSearchMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">SEARCH_SERVICES</span><span class="p">,</span>
    <span class="n">dialogue_reference</span><span class="o">=</span><span class="p">(</span><span class="n">my_dialogue_reference</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<ul>
<li>
<p>The <a href="../simple-oef">SOEF search node</a> will respond with a message, say <code>msg</code> of type <code>OefSearchMessage</code>, of performative <code>OefSearchMessage.Performative.SEARCH_RESULT</code>. To access the tuple of agents which match the query, simply use <code>msg.agents</code>. In particular, this will return the agent addresses matching the query. The <a href="../identity">agent address</a> can then be used to send a message to the agent utilising the <a href="../oef-ledger">P2P agent communication network</a> and any protocol other than <code>fetchai/oef_search:0.8.0</code>.</p>
</li>
<li>
<p>If the <a href="../simple-oef">SOEF search node</a> encounters any errors with the messages you send, it will return an <code>OefSearchMessage</code> of performative <code>OefSearchMessage.Performative.OEF_ERROR</code> and indicate the error operation encountered:</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">OefErrorOperation</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot;This class represents an instance of OefErrorOperation.&quot;&quot;&quot;</span>
    <span class="n">REGISTER_SERVICE</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">UNREGISTER_SERVICE</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">SEARCH_SERVICES</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">SEND_MESSAGE</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="n">OTHER</span> <span class="o">=</span> <span class="mi">10000</span>
</code></pre></div>

<h2 id="fetchaifipa080-protocol"><code>fetchai/fipa:0.8.0</code> protocol</h2>
<p>This protocol provides classes and functions necessary for communication between AEAs via a variant of the <a href="http://www.fipa.org/repository/aclspecs.html" target="_blank">FIPA</a> Agent Communication Language.</p>
<p>The <code>fetchai/fipa:0.8.0</code> protocol definition includes a <code>FipaMessage</code> with the following performatives:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Performative</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performatives for the fipa protocol.&quot;&quot;&quot;</span>

    <span class="n">ACCEPT</span> <span class="o">=</span> <span class="s2">&quot;accept&quot;</span>
    <span class="n">ACCEPT_W_INFORM</span> <span class="o">=</span> <span class="s2">&quot;accept_w_inform&quot;</span>
    <span class="n">CFP</span> <span class="o">=</span> <span class="s2">&quot;cfp&quot;</span>
    <span class="n">DECLINE</span> <span class="o">=</span> <span class="s2">&quot;decline&quot;</span>
    <span class="n">INFORM</span> <span class="o">=</span> <span class="s2">&quot;inform&quot;</span>
    <span class="n">MATCH_ACCEPT</span> <span class="o">=</span> <span class="s2">&quot;match_accept&quot;</span>
    <span class="n">MATCH_ACCEPT_W_INFORM</span> <span class="o">=</span> <span class="s2">&quot;match_accept_w_inform&quot;</span>
    <span class="n">PROPOSE</span> <span class="o">=</span> <span class="s2">&quot;propose&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the string representation.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
</code></pre></div>

<p><code>FipaMessages</code> are constructed with a <code>performative</code>, <code>dialogue_reference</code>, <code>message_id</code>, and <code>target</code> as well as the <code>kwargs</code> specific to each message performative.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">performative</span><span class="p">:</span> <span class="n">Performative</span><span class="p">,</span>
    <span class="n">dialogue_reference</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
    <span class="n">message_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">target</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

<p>The <code>fetchai/fipa:0.8.0</code> protocol also defines a <code>FipaDialogue</code> class which specifies the valid reply structure and provides other helper methods to maintain dialogues.</p>
<p>For examples of the usage of the <code>fetchai/fipa:0.8.0</code> protocol check out the <a href="../generic-skills-step-by-step" target="_blank"> generic skills step by step guide</a>.</p>
<h3 id="fipa-dialogue">Fipa dialogue</h3>
<p>Below, we give an example of a dialogue between two agents. In practice; both dialogues would be maintained in the respective agent.</p>
<p>We first create concrete implementations of <code>FipaDialogue</code> and <code>FipaDialogues</code> for the buyer and seller:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">aea.common</span> <span class="kn">import</span> <span class="n">Address</span>
<span class="kn">from</span> <span class="nn">aea.helpers.search.models</span> <span class="kn">import</span> <span class="n">Constraint</span><span class="p">,</span> <span class="n">ConstraintType</span><span class="p">,</span> <span class="n">Description</span><span class="p">,</span> <span class="n">Query</span>
<span class="kn">from</span> <span class="nn">aea.mail.base</span> <span class="kn">import</span> <span class="n">Envelope</span>
<span class="kn">from</span> <span class="nn">aea.protocols.base</span> <span class="kn">import</span> <span class="n">Message</span>
<span class="kn">from</span> <span class="nn">aea.protocols.dialogue.base</span> <span class="kn">import</span> <span class="n">Dialogue</span> <span class="k">as</span> <span class="n">BaseDialogue</span>
<span class="kn">from</span> <span class="nn">aea.protocols.dialogue.base</span> <span class="kn">import</span> <span class="n">DialogueLabel</span>

<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.fipa.dialogues</span> <span class="kn">import</span> <span class="n">FipaDialogue</span><span class="p">,</span> <span class="n">FipaDialogues</span>
<span class="kn">from</span> <span class="nn">packages.fetchai.protocols.fipa.message</span> <span class="kn">import</span> <span class="n">FipaMessage</span>


<span class="k">class</span> <span class="nc">BuyerDialogue</span><span class="p">(</span><span class="n">FipaDialogue</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogue class maintains state of a dialogue and manages it.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dialogue_label</span><span class="p">:</span> <span class="n">DialogueLabel</span><span class="p">,</span>
        <span class="n">self_address</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
        <span class="n">role</span><span class="p">:</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span>
        <span class="n">message_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">FipaMessage</span><span class="p">]</span> <span class="o">=</span> <span class="n">FipaMessage</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a dialogue.</span>

<span class="sd">        :param dialogue_label: the identifier of the dialogue</span>
<span class="sd">        :param self_address: the address of the entity for whom this dialogue is maintained</span>
<span class="sd">        :param role: the role of the agent this dialogue is maintained for</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FipaDialogue</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">dialogue_label</span><span class="o">=</span><span class="n">dialogue_label</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="n">self_address</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="n">role</span><span class="p">,</span>
            <span class="n">message_class</span><span class="o">=</span><span class="n">message_class</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proposal</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: Optional[Description]</span>


<span class="k">class</span> <span class="nc">BuyerDialogues</span><span class="p">(</span><span class="n">FipaDialogues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogues class keeps track of all dialogues.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_address</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize dialogues.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">role_from_first_message</span><span class="p">(</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span> <span class="n">receiver_address</span><span class="p">:</span> <span class="n">Address</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Infer the role of the agent from an incoming/outgoing first message</span>

<span class="sd">            :param message: an incoming/outgoing first message</span>
<span class="sd">            :param receiver_address: the address of the receiving agent</span>
<span class="sd">            :return: The role of the agent</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">BaseFipaDialogue</span><span class="o">.</span><span class="n">Role</span><span class="o">.</span><span class="n">BUYER</span>

        <span class="n">FipaDialogues</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="n">self_address</span><span class="p">,</span>
            <span class="n">role_from_first_message</span><span class="o">=</span><span class="n">role_from_first_message</span><span class="p">,</span>
            <span class="n">dialogue_class</span><span class="o">=</span><span class="n">FipaDialogue</span><span class="p">,</span>
        <span class="p">)</span>


<span class="k">class</span> <span class="nc">SellerDialogue</span><span class="p">(</span><span class="n">FipaDialogue</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogue class maintains state of a dialogue and manages it.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dialogue_label</span><span class="p">:</span> <span class="n">DialogueLabel</span><span class="p">,</span>
        <span class="n">self_address</span><span class="p">:</span> <span class="n">Address</span><span class="p">,</span>
        <span class="n">role</span><span class="p">:</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">,</span>
        <span class="n">message_class</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">FipaMessage</span><span class="p">]</span> <span class="o">=</span> <span class="n">FipaMessage</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a dialogue.</span>

<span class="sd">        :param dialogue_label: the identifier of the dialogue</span>
<span class="sd">        :param self_address: the address of the entity for whom this dialogue is maintained</span>
<span class="sd">        :param role: the role of the agent this dialogue is maintained for</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">FipaDialogue</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">dialogue_label</span><span class="o">=</span><span class="n">dialogue_label</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="n">self_address</span><span class="p">,</span>
            <span class="n">role</span><span class="o">=</span><span class="n">role</span><span class="p">,</span>
            <span class="n">message_class</span><span class="o">=</span><span class="n">message_class</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">proposal</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: Optional[Description]</span>


<span class="k">class</span> <span class="nc">SellerDialogues</span><span class="p">(</span><span class="n">FipaDialogues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The dialogues class keeps track of all dialogues.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">self_address</span><span class="p">:</span> <span class="n">Address</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize dialogues.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">role_from_first_message</span><span class="p">(</span>
            <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">,</span> <span class="n">receiver_address</span><span class="p">:</span> <span class="n">Address</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseDialogue</span><span class="o">.</span><span class="n">Role</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;Infer the role of the agent from an incoming/outgoing first message</span>

<span class="sd">            :param message: an incoming/outgoing first message</span>
<span class="sd">            :param receiver_address: the address of the receiving agent</span>
<span class="sd">            :return: The role of the agent</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">return</span> <span class="n">FipaDialogue</span><span class="o">.</span><span class="n">Role</span><span class="o">.</span><span class="n">SELLER</span>

        <span class="n">FipaDialogues</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">self_address</span><span class="o">=</span><span class="n">self_address</span><span class="p">,</span>
            <span class="n">role_from_first_message</span><span class="o">=</span><span class="n">role_from_first_message</span><span class="p">,</span>
            <span class="n">dialogue_class</span><span class="o">=</span><span class="n">FipaDialogue</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div>

<p>Next, we can immitate a dialogue between the buyer and the seller. We first instantiate the dialogues models:</p>
<div class="highlight"><pre><span></span><code><span class="n">buyer_address</span> <span class="o">=</span> <span class="s2">&quot;buyer_address_stub&quot;</span>
<span class="n">seller_address</span> <span class="o">=</span> <span class="s2">&quot;seller_address_stub&quot;</span>
<span class="n">buyer_dialogues</span> <span class="o">=</span> <span class="n">BuyerDialogues</span><span class="p">(</span><span class="n">buyer_address</span><span class="p">)</span>
<span class="n">seller_dialogues</span> <span class="o">=</span> <span class="n">SellerDialogues</span><span class="p">(</span><span class="n">seller_address</span><span class="p">)</span>
</code></pre></div>

<p>First, the buyer creates a message destined for the seller and updates the dialogues:</p>
<div class="highlight"><pre><span></span><code><span class="n">cfp_msg</span> <span class="o">=</span> <span class="n">FipaMessage</span><span class="p">(</span>
    <span class="n">message_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">dialogue_reference</span><span class="o">=</span><span class="n">buyer_dialogues</span><span class="o">.</span><span class="n">new_self_initiated_dialogue_reference</span><span class="p">(),</span>
    <span class="n">target</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">performative</span><span class="o">=</span><span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">CFP</span><span class="p">,</span>
    <span class="n">query</span><span class="o">=</span><span class="n">Query</span><span class="p">([</span><span class="n">Constraint</span><span class="p">(</span><span class="s2">&quot;something&quot;</span><span class="p">,</span> <span class="n">ConstraintType</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">))]),</span>
<span class="p">)</span>
<span class="n">cfp_msg</span><span class="o">.</span><span class="n">counterparty</span> <span class="o">=</span> <span class="n">seller_addr</span>

<span class="c1"># Extends the outgoing list of messages.</span>
<span class="n">buyer_dialogue</span> <span class="o">=</span> <span class="n">buyer_dialogues</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cfp_msg</span><span class="p">)</span>
</code></pre></div>

<p>If the message has been correctly constructed, the <code>buyer_dialogue</code> will be returned, otherwise it will be <code>None</code>.</p>
<p>In a skill, the message could now be sent:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># In a skill we would do:</span>
<span class="c1"># self.context.outbox.put_message(message=cfp_msg)</span>
</code></pre></div>

<p>However, here we simply continue with the seller:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># change the incoming message field &amp; counterparty</span>
<span class="n">cfp_msg</span><span class="o">.</span><span class="n">is_incoming</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">cfp_msg</span><span class="o">.</span><span class="n">counterparty</span> <span class="o">=</span> <span class="n">buyer_address</span>
</code></pre></div>

<p>In the skill, the above two lines will be done by the framework; you can simply receive the message in the handler.</p>
<p>We update the seller's dialogues model next to generate a new dialogue:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Creates a new dialogue for the seller side based on the income message.</span>
<span class="n">seller_dialogue</span> <span class="o">=</span> <span class="n">seller_dialogues</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cfp_msg</span><span class="p">)</span>
</code></pre></div>

<p>Next, the seller can generate a proposal:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Generate a proposal message to send to the buyer.</span>
<span class="n">proposal</span> <span class="o">=</span> <span class="n">Description</span><span class="p">({</span><span class="s2">&quot;foo1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;bar1&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">message_id</span> <span class="o">=</span> <span class="n">cfp_msg</span><span class="o">.</span><span class="n">message_id</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">cfp_msg</span><span class="o">.</span><span class="n">message_id</span>
<span class="n">proposal_msg</span> <span class="o">=</span> <span class="n">FipaMessage</span><span class="p">(</span>
    <span class="n">message_id</span><span class="o">=</span><span class="n">message_id</span><span class="p">,</span>
    <span class="n">dialogue_reference</span><span class="o">=</span><span class="n">seller_dialogue</span><span class="o">.</span><span class="n">dialogue_label</span><span class="o">.</span><span class="n">dialogue_reference</span><span class="p">,</span>
    <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span>
    <span class="n">performative</span><span class="o">=</span><span class="n">FipaMessage</span><span class="o">.</span><span class="n">Performative</span><span class="o">.</span><span class="n">PROPOSE</span><span class="p">,</span>
    <span class="n">proposal</span><span class="o">=</span><span class="n">proposal</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">proposal_msg</span><span class="o">.</span><span class="n">counterparty</span> <span class="o">=</span> <span class="n">cfp_msg</span><span class="o">.</span><span class="n">counterparty</span>

<span class="c1"># Then we update the dialogue</span>
<span class="n">seller_dialogue</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">proposal_msg</span><span class="p">)</span>
</code></pre></div>

<p>In a skill, the message could now be sent:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># In a skill we would do:</span>
<span class="c1"># self.context.outbox.put_message(message=proposal_msg)</span>
</code></pre></div>

<p>The dialogue can continue like this.</p>
<p>To retrieve a dialogue for a given message, we can do the following:</p>
<div class="highlight"><pre><span></span><code><span class="n">retrieved_dialogue</span> <span class="o">=</span> <span class="n">seller_dialogues</span><span class="o">.</span><span class="n">get_dialogue</span><span class="p">(</span><span class="n">cfp_msg</span><span class="p">)</span>
</code></pre></div>

<p><br /></p>


                                </section>

                            </div> <!-- .page-inner end -->

                            <div class="bottomnav">
                                
                                <a href="../connection/" class="button left"><strong>Previous:</strong></br>Connections</a>
                                
                                <a href="../skill/" class="button right"><strong>Next:</strong></br>Skills</a>
                            </div><!-- .bottomnav end -->

                        </div> <!-- .page-wrapper end -->

                    </div> <!-- .body-inner end -->
                </div> <!-- .book-body end -->

            </div><!-- .book end -->
        </div><!-- #content-wrap -->

        <footer>
            <div class="corset">
                <div class="col-1">
                    <div class="social">
                        <a href="https://t.me/fetch_ai" target="_blank"><i class="fab fa-telegram-plane" aria-hidden="true"></i></a>
                        <a href="https://twitter.com/fetch_ai?lang=en" target="_blank"><i class="fab fa-twitter" aria-hidden="true"></i></a>
                        <a href="https://www.linkedin.com/company/fetch-ai/" target="_blank"><i class="fab fa-linkedin" aria-hidden="true"></i></a>
                        <a href="https://www.youtube.com/c/FetchAI" target="_blank"><i class="fab fa-youtube" aria-hidden="true"></i></a>
                        <a href="https://medium.com/fetch-ai" target="_blank"><i class="fab fa-medium-m" aria-hidden="true"></i></a>
                        <a href="https://github.com/fetchai" target="_blank"><i class="fab fa-github" aria-hidden="true"></i></a>
                    </div>
                </div>
                <div class="col-2">Copyright © <a href="https://fetch.ai">Fetch.ai</a> <span class="year">2019</span></div>
            </div>
        </footer>
    </div><!-- end #page-container -->

    <link rel="stylesheet" id="font-awesome-css" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" type="text/css" media="all">
    <script src="../../js/main.js"></script>
    <script src="../../js/menu.js"></script>
    <script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script>
    <script src="../../search/main.js"></script>
</body>

</html>